import{d as e,b as a,e as s,f as l,cp as t,b6 as d,a_ as r,o as n,c as u,k as o,w as c,j as i,a as m,X as p,t as v,z as f,F as h,n as w,h as x,aq as _,aa as y,Z as b,l as g,_ as k}from"./index-4bfb878d.js";const V={class:"flex"},M=i("div",{class:"card-header"},[i("span",null,"连接")],-1),D={class:"flex items-center"},L=i("span",{class:"text-lg font-medium mr-4"}," 连接状态: ",-1),U=i("hr",{class:"my-4"},null,-1),Y={class:"flex"},j=i("p",{class:"text-lg font-medium mt-4"},"设置",-1),R=i("hr",{class:"my-4"},null,-1),S=i("div",{class:"card-header"},[i("span",null,"消息记录")],-1),z={class:"max-h-80 overflow-auto"},C={class:"flex items-center"},E=i("span",{class:"mr-2 text-primary font-medium"},"收到消息:",-1),H=k(e({__name:"index",setup(e){const k=a(),H=s(""),N=s("http://server-api:48080/websocket/message".replace("http","ws")+"?userId="+k.getUser.id),O=l({recordList:[]}),{status:q,data:F,send:I,close:J,open:P}=t(N.value,{autoReconnect:!1,heartbeat:!0});d((()=>{if(F.value)try{const e=JSON.parse(F.value);O.recordList.push(e)}catch(e){O.recordList.push({res:F.value,id:Math.ceil(1e3*Math.random()),time:(new Date).getTime()})}}));const T=r((()=>"OPEN"===q.value)),X=r((()=>T.value?"success":"red")),Z=r((()=>[...O.recordList].reverse()));function A(){I(H.value),H.value=""}function B(){T.value?J():P()}return(e,a)=>{const s=_,l=y,t=b,d=g;return n(),u("div",V,[o(d,{class:"w-1/2",gutter:12,shadow:"always"},{header:c((()=>[M])),default:c((()=>[i("div",D,[L,o(s,{color:m(X)},{default:c((()=>[p(v(m(q)),1)])),_:1},8,["color"])]),U,i("div",Y,[o(l,{modelValue:m(N),"onUpdate:modelValue":a[0]||(a[0]=e=>f(N)?N.value=e:null),disabled:""},{prepend:c((()=>[p(" 服务地址 ")])),_:1},8,["modelValue"]),o(t,{type:m(T)?"danger":"primary",onClick:B},{default:c((()=>[p(v(m(T)?"关闭连接":"开启连接"),1)])),_:1},8,["type"])]),j,R,o(l,{modelValue:m(H),"onUpdate:modelValue":a[1]||(a[1]=e=>f(H)?H.value=e:null),autosize:{minRows:2,maxRows:4},type:"textarea",disabled:!m(T),clearable:""},null,8,["modelValue","disabled"]),o(t,{type:"primary",block:"",class:"mt-4",disabled:!m(T),onClick:A},{default:c((()=>[p(" 发送 ")])),_:1},8,["disabled"])])),_:1}),o(d,{class:"w-1/2",gutter:12,shadow:"always"},{header:c((()=>[S])),default:c((()=>[i("div",z,[i("ul",null,[(n(!0),u(h,null,w(m(Z),(e=>(n(),u("li",{class:"mt-2",key:e.time},[i("div",C,[E,i("span",null,v(m(x)(e.time).format("YYYY-MM-DD HH:mm:ss")),1)]),i("div",null,v(e.res),1)])))),128))])])])),_:1})])}}}),[["__file","/Users/alex/Downloads/万界星空/产品研发/MES框架/dev/xiejinrun/new_open_mes_front/src/views/infra/webSocket/index.vue"]]);export{H as default};
