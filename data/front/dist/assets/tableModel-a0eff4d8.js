import{f as e,r as a,d as l,e as t,o as r,c as n,k as p,w as d,X as s,I as i,G as u,a as o,t as m,J as y,F as c,aH as b,aK as v,aR as f,Z as h,v as _,E as T,b7 as g,aq as k,b8 as w,cg as V,ab as I,aa as C,ac as F,ad as N,ae as x,a0 as z,aI as L,_ as S}from"./index-4bfb878d.js";import{h as U}from"./tree-5260b4e2.js";const j="Y",q={[j]:"是",N:"否"},M=e([{type:"input",label:"类型名称",prop:"machineryTypeName",placeholder:"请输入设备类型名称"},{type:"select",label:"是否启用",prop:"enableFlag",placeholder:"选择是或否",options:[{value:j,label:"是"},{value:"N",label:"否"}]}]),$=async e=>await a.get({url:"/admin-api/mes/dv/machineryType/list",params:e}),A=S(l({__name:"tableModel",props:{tableFormList:{type:Array,default:()=>Array},tableLoading:{type:Boolean,default:!1}},emits:["updateTableList"],setup(l,{emit:S}){const M=t(),A=e({parentTypeId:[{required:!0,message:"父分类不能为空",trigger:"blur"}],machineryTypeName:[{required:!0,message:"设备类型名称",trigger:"blur"}],enableFlag:[{required:!0,message:"请选择是否启用",trigger:["blur"]}]}),E=t({value:"id",label:"machineryTypeName",children:"children",checkStrictly:!0});let O=e([]),R=t({parentTypeId:null,id:"",machineryTypeName:"",remark:"",enableFlag:j});const Y=t(""),B=t(!1),D=t(!0),G=t(!0),H=()=>{G.value=!G.value,D.value=!D.value,b((()=>{G.value=!G.value}))},J=()=>{R.value={parentTypeId:null,id:"",machineryTypeName:"",machineryTypeCode:"",remark:"",enableFlag:j}},K=e=>{(async e=>await a.get({url:`/admin-api/mes/dv/machineryType/get/${e}`}))(null==e?void 0:e.id).then((e=>{R.value=e}))},P=e=>{v.confirm(`是否确认删除【${null==e?void 0:e.machineryTypeName}】的分类？`).then((()=>(async e=>await a.delete({url:`/admin-api/mes/dv/machineryType/${e}`}))(e.id).then((e=>{e&&(f.success("删除成功"),S("updateTableList"))}))))},X=async e=>{e&&await e.validate((e=>{var l;if(e){const e={...R.value,parentTypeId:"number"==typeof R.value.parentTypeId?R.value.parentTypeId:null==(l=R.value.parentTypeId)?void 0:l.slice(-1).toString()};R.value.id?(async e=>await a.put({url:"/admin-api/mes/dv/machineryType/update",data:e}))(e).then((e=>{e&&(f.success("修改成功"),B.value=!1,S("updateTableList"))})):(async e=>await a.post({url:"/admin-api/mes/dv/machineryType/save",data:e}))(e).then((e=>{e&&(f.success("新增成功"),B.value=!B.value,S("updateTableList"))}))}}))},Z=()=>{$().then((e=>{const{list:a=[]}=e||{},l=U(a,"id","parentTypeId");O=l,B.value=!B.value}))},Q=()=>{J(),B.value=!B.value};return(e,a)=>{const t=h,b=_,v=T,f=g,S=k,U=w,$=V,W=I,ee=C,ae=F,le=N,te=x,re=z,ne=L;return r(),n(c,null,[p(v,{gutter:10,class:"mb8"},{default:d((()=>[p(b,{span:1.5,style:{"margin-bottom":"16px"}},{default:d((()=>[p(t,{icon:"Switch",type:"info",plain:"",onClick:H,disabled:!l.tableFormList.length},{default:d((()=>[s("展开/折叠")])),_:1},8,["disabled"])])),_:1},8,["span"])])),_:1}),G.value?i((r(),u(U,{key:0,data:l.tableFormList,"row-key":"id","default-expand-all":D.value,"tree-props":{children:"children",hasChildren:"hasChildren"}},{default:d((()=>[p(f,{label:"设备类型编码",prop:"machineryTypeCode"}),p(f,{label:"设备类型名称",prop:"machineryTypeName"}),p(f,{prop:"enableFlag",label:"是否启用"},{default:d((e=>[p(S,{type:e.row.enableFlag===o(j)?"success":"warning"},{default:d((()=>[s(m(o(q)[e.row.enableFlag]),1)])),_:2},1032,["type"])])),_:1}),p(f,{label:"备注",prop:"remark"}),p(f,{label:"操作"},{default:d((e=>[p(t,{style:{"font-size":"17px"},type:"primary",link:"",key:"plain",size:"small",onClick:a=>{return l=e.row,J(),void(l&&(R.value.parentTypeId=l.id,Y.value="添加设备分类",Z()));var l}},{default:d((()=>[s("新增")])),_:2},1032,["onClick"]),p(t,{style:{"font-size":"17px"},type:"primary",link:"",key:"plain",size:"small",onClick:a=>(async e=>{e&&(Z(),K(e),Y.value="修改分类")})(e.row)},{default:d((()=>[s("修改")])),_:2},1032,["onClick"]),0!==e.row.parentTypeId?(r(),u(t,{style:{"font-size":"17px"},type:"danger",link:"",key:"plain",size:"small",onClick:a=>P(e.row)},{default:d((()=>[s("删除")])),_:2},1032,["onClick"])):y("",!0)])),_:1})])),_:1},8,["data","default-expand-all"])),[[ne,l.tableLoading]]):y("",!0),p(re,{title:Y.value,modelValue:B.value,"onUpdate:modelValue":a[6]||(a[6]=e=>B.value=e),width:"60%"},{footer:d((()=>[p(t,{onClick:a[5]||(a[5]=e=>X(M.value)),type:"primary",plain:""},{default:d((()=>[s("确定")])),_:1}),p(t,{onClick:Q},{default:d((()=>[s("取消")])),_:1})])),default:d((()=>[p(te,{ref_key:"ruleFormRef",ref:M,model:o(R),rules:A,"label-width":"110px"},{default:d((()=>[p(v,null,{default:d((()=>[0!==o(R).parentTypeId?(r(),u(b,{key:0,span:8},{default:d((()=>[p(W,{label:"父级分类",prop:"parentTypeId"},{default:d((()=>[p($,{options:o(O),"show-all-levels":!1,props:E.value,modelValue:o(R).parentTypeId,"onUpdate:modelValue":a[0]||(a[0]=e=>o(R).parentTypeId=e)},null,8,["options","props","modelValue"])])),_:1})])),_:1})):y("",!0),p(b,{span:8},{default:d((()=>[p(W,{label:"设备类型",prop:"machineryTypeName"},{default:d((()=>[p(ee,{modelValue:o(R).machineryTypeName,"onUpdate:modelValue":a[1]||(a[1]=e=>o(R).machineryTypeName=e),placeholder:"请输入设备类型"},null,8,["modelValue"])])),_:1})])),_:1}),p(b,{span:8},{default:d((()=>[p(W,{label:"设备编号",prop:"machineryTypeCode"},{default:d((()=>[p(ee,{modelValue:o(R).machineryTypeCode,"onUpdate:modelValue":a[2]||(a[2]=e=>o(R).machineryTypeCode=e),placeholder:"请输入设备编号"},null,8,["modelValue"])])),_:1})])),_:1}),p(b,{span:8},{default:d((()=>[p(W,{label:"启用状态",prop:"enableFlag"},{default:d((()=>[p(le,{modelValue:o(R).enableFlag,"onUpdate:modelValue":a[3]||(a[3]=e=>o(R).enableFlag=e)},{default:d((()=>[p(ae,{label:"Y",size:"large"},{default:d((()=>[s("是")])),_:1}),p(ae,{label:"N",size:"large"},{default:d((()=>[s("否")])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1}),p(b,{span:8},{default:d((()=>[p(W,{label:"备注",prop:"remark"},{default:d((()=>[p(ee,{rows:3,modelValue:o(R).remark,"onUpdate:modelValue":a[4]||(a[4]=e=>o(R).remark=e),autosize:"",type:"textarea",placeholder:"请输入内容"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])],64)}}}),[["__scopeId","data-v-e2b8bb0c"],["__file","/Users/alex/Downloads/万界星空/产品研发/MES框架/dev/xiejinrun/new_open_mes_front/src/views/facilityManage/typeSet/components/tableModel.vue"]]),E=Object.freeze(Object.defineProperty({__proto__:null,default:A},Symbol.toStringTag,{value:"Module"}));export{E as a,$ as q,M as s,A as t};
