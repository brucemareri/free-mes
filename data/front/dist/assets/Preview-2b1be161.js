import{d as e,q as a,K as l,f as t,e as s,o,G as n,w as i,j as r,k as c,a as d,c as u,F as f,n as p,t as m,a8 as h,ch as v,a9 as _,l as g,M as w,A as x,B as y,a0 as j,_ as P}from"./index-4bfb878d.js";import{a as k}from"./tree-5260b4e2.js";import{p as V}from"./index-33f98cf5.js";const N={class:"flex"},b=P(e({__name:"Preview",setup(e,{expose:P}){const{t:b}=a(),T=l(),C=t({open:!1,titel:"代码预览",fileTree:[],activeName:""}),I=s(),S=async(e,a)=>{if(a&&!a.isLeaf)return!1;C.activeName=e.id},U=e=>{let a={},l=[];for(const t of e){let e=t.filePath.split("/"),s="";if(e[e.length-1].indexOf(".java")>=0){let a=[];for(let l=0;l<e.length;l++){let t=e[l];if("java"!==t){a.push(t);continue}a.push(t);let s="";for(;l<e.length&&(t=e[l+1],"controller"!==t&&"convert"!==t&&"dal"!==t&&"enums"!==t&&"service"!==t&&"vo"!==t&&"mysql"!==t&&"dataobject"!==t);)s=s?s+"."+t:t,l++;s&&a.push(s)}e=a}for(let t=0;t<e.length;t++){let o=s;s=0===s.length?e[t]:s.replaceAll(".","/")+"/"+e[t],a[s]||(a[s]=!0,l.push({id:s,label:e[t],parentId:o||"/"}))}}return l};return P({show:async e=>{const a=await V(e.id);let l=U(a);I.value=a,C.fileTree=k(l,"id","parentId","children","/"),C.activeName=a[0].filePath,C.open=!0}}),(e,a)=>{const l=v,t=_,s=g,P=w,k=x,V=y,U=j;return o(),n(U,{title:"预览",modelValue:d(C).open,"onUpdate:modelValue":a[1]||(a[1]=e=>d(C).open=e)},{default:i((()=>[r("div",N,[c(s,{class:"w-1/4",gutter:12,shadow:"hover"},{default:i((()=>[c(t,{height:"calc(100vh - 88px - 40px - 50px)"},{default:i((()=>[c(l,{ref:"treeRef","node-key":"id",data:d(C).fileTree,"expand-on-click-node":!1,"highlight-current":"",onNodeClick:S},null,8,["data"])])),_:1})])),_:1}),c(s,{class:"w-3/4 ml-3",gutter:12,shadow:"hover"},{default:i((()=>[c(V,{modelValue:d(C).activeName,"onUpdate:modelValue":a[0]||(a[0]=e=>d(C).activeName=e)},{default:i((()=>[(o(!0),u(f,null,p(d(I),(e=>(o(),n(k,{label:e.filePath.substring(e.filePath.lastIndexOf("/")+1),name:e.filePath,key:e.filePath},{default:i((()=>[c(P,{style:{float:"right"},title:d(b)("common.copy"),onClick:a=>(async e=>{const{copy:a,copied:l,isSupported:t}=h({source:e});t?(await a(),d(l)&&T.success(b("common.copySuccess"))):T.error(b("common.copyError"))})(e.code)},null,8,["title","onClick"]),r("pre",null,m(e.code),1)])),_:2},1032,["label","name"])))),128))])),_:1},8,["modelValue"])])),_:1})])])),_:1},8,["modelValue"])}}}),[["__file","/Users/alex/Downloads/万界星空/产品研发/MES框架/dev/xiejinrun/new_open_mes_front/src/views/infra/codegen/components/Preview.vue"]]);export{b as default};
