import{q as e,f as a,D as t,d as l,K as s,cN as i,cO as o,e as c,aS as r,a as n,C as d,o as u,c as p,k as m,w as y,I as f,J as v,G as k,X as C,t as h,z as w,j as S,cP as T,aH as _,cQ as b,cR as g,L as U,M as x,N as R,l as V,aq as M,aa as P,aJ as I,a0 as j,_ as D}from"./index-4bfb878d.js";import{r as A}from"./formRules-eb36c657.js";import{u as F}from"./useVxeCrudSchemas-092b8963.js";import{g as O,d as N,a as X,c as z,u as E}from"./dict.type-24e241ce.js";import{u as K}from"./useXTable-309dffed.js";const{t:L}=e(),W=a({name:[A],type:[A]}),q=a({primaryKey:"id",primaryType:null,action:!0,actionWidth:"140px",searchSpan:12,columns:[{title:"字典名称",field:"name",isSearch:!0},{title:"字典类型",field:"type",isSearch:!0},{title:L("common.status"),field:"status",dictType:t.COMMON_STATUS,dictClass:"number",table:{width:70}},{title:L("common.createTime"),field:"createTime",formatter:"formatDate",isForm:!1,isTable:!1,search:{show:!0,itemRender:{name:"XDataTimePicker"}}},{title:L("form.remark"),field:"remark",isTable:!1,form:{componentProps:{type:"textarea",rows:4},colProps:{span:24}}}]}),{allSchemas:J}=F(q),{t:Q}=e(),G=a({label:[A],value:[A],sort:[A]}),H=a({primaryKey:"id",primaryType:null,action:!0,actionWidth:"140px",searchSpan:12,columns:[{title:"字典类型",field:"dictType",isTable:!1,isForm:!1},{title:"数据标签",field:"label",isSearch:!0},{title:"数据键值",field:"value"},{title:"颜色",field:"cssClass",isTable:!1,form:{component:"ColorPicker",componentProps:{predefine:["#ffffff","#409eff","#67c23a","#e6a23c","#f56c6c","#909399","#c71585"]}}},{title:"显示排序",field:"sort",isTable:!1},{title:Q("common.status"),field:"status",dictType:t.COMMON_STATUS,dictClass:"number"},{title:Q("form.remark"),field:"remark",form:{component:"Input",componentProps:{type:"textarea",rows:4},colProps:{span:24}},isTable:!1}]}),{allSchemas:B}=F(H),Y={class:"flex"},Z=S("div",{class:"card-header"},[S("span",null,"字典分类")],-1),$=S("div",{class:"card-header"},[S("span",null,"字典数据")],-1),ee={key:0},ae=[S("span",null,"请从左侧选择",-1)],te={key:1},le=l({name:"Dict"}),se=D(l({...le,setup(t){const{t:l}=e(),S=s(),[D,{reload:A,deleteData:F}]=K({allSchemas:J,getListApi:O,deleteApi:N}),L=a({dictType:null}),[q,{reload:Q,deleteData:H}]=K({allSchemas:B,params:L,getListApi:i,deleteApi:o}),le=c(""),se=c(""),ie=c(!1),oe=async({row:e})=>{ie.value=!0,L.dictType=e.type,await _(),await Q(),se.value=e.type},ce=c(!1),re=c("edit"),ne=c(!1),de=c(),ue=c(),pe=c(""),me=e=>{re.value=l("action."+e),pe.value=e,ce.value=!0};r(le,(e=>{var a;null==(a=n(de))||a.setValues({type:e})}));const ye=async()=>{var e;const a=null==(e=n(de))?void 0:e.getElFormRef();a&&a.validate((async e=>{var a;if(e&&""!=le.value){ne.value=!0;try{const e=null==(a=n(de))?void 0:a.formModel;"typeCreate"===pe.value?(e.type=le.value,await z(e),S.success(l("common.createSuccess"))):"typeUpdate"===pe.value&&(await E(e),S.success(l("common.updateSuccess"))),ce.value=!1}finally{ne.value=!1,A()}}}))},fe=async()=>{var e;const a=null==(e=n(ue))?void 0:e.getElFormRef();a&&a.validate((async e=>{var a;if(e){ne.value=!0;try{const e=null==(a=n(ue))?void 0:a.formModel;"dataCreate"===pe.value?(e.dictType=se.value,await b(e),S.success(l("common.createSuccess"))):"dataUpdate"===pe.value&&(await g(e),S.success(l("common.updateSuccess"))),ce.value=!1}finally{ne.value=!1,Q()}}}))};return(e,a)=>{const t=U,s=x,i=R,o=V,c=M,r=P,S=I,_=j,b=d("hasPermi");return u(),p("div",Y,[m(o,{class:"w-1/2 dict",gutter:12,shadow:"always"},{header:y((()=>[Z])),default:y((()=>[m(i,{onRegister:n(D),onCellClick:oe},{toolbar_buttons:y((()=>[f(m(t,{type:"primary",preIcon:"ep:zoom-in",title:n(l)("action.add"),onClick:a[0]||(a[0]=e=>(le.value="",void me("typeCreate")))},null,8,["title"]),[[b,["system:dict:create"]]])])),actionbtns_default:y((({row:e})=>[f(m(s,{preIcon:"ep:edit",title:n(l)("action.edit"),onClick:a=>(async e=>{var a;me("typeUpdate");const t=await X(e);le.value=t.type,null==(a=n(de))||a.setValues(t)})(e.id)},null,8,["title","onClick"]),[[b,["system:dict:update"]]]),f(m(s,{preIcon:"ep:delete",title:n(l)("action.del"),onClick:a=>n(F)(e.id)},null,8,["title","onClick"]),[[b,["system:dict:delete"]]])])),_:1},8,["onRegister"])])),_:1}),m(o,{class:"w-1/2 dict ml-3",gutter:12,shadow:"hover"},{header:y((()=>[$])),default:y((()=>[n(ie)?v("",!0):(u(),p("div",ee,ae)),n(ie)?(u(),p("div",te,[m(i,{onRegister:n(q)},{toolbar_buttons:y((()=>[f(m(t,{type:"primary",preIcon:"ep:zoom-in",title:n(l)("action.add"),onClick:a[1]||(a[1]=e=>{me("dataCreate")})},null,8,["title"]),[[b,["system:dict:create"]]])])),actionbtns_default:y((({row:e})=>[f(m(s,{preIcon:"ep:edit",title:n(l)("action.edit"),onClick:a=>(async e=>{var a;me("dataUpdate");const t=await T(e);null==(a=n(ue))||a.setValues(t)})(e.id)},null,8,["title","onClick"]),[[b,["system:dict:update"]]]),f(m(s,{preIcon:"ep:delete",title:n(l)("action.del"),onClick:a=>n(H)(e.id)},null,8,["title","onClick"]),[[b,["system:dict:delete"]]])])),_:1},8,["onRegister"])])):v("",!0)])),_:1}),m(_,{id:"dictModel",modelValue:n(ce),"onUpdate:modelValue":a[4]||(a[4]=e=>w(ce)?ce.value=e:null),title:n(re)},{footer:y((()=>[["typeCreate","typeUpdate"].includes(n(pe))?(u(),k(t,{key:0,type:"primary",title:n(l)("action.save"),loading:n(ne),onClick:ye},null,8,["title","loading"])):v("",!0),["dataCreate","dataUpdate"].includes(n(pe))?(u(),k(t,{key:1,type:"primary",title:n(l)("action.save"),loading:n(ne),onClick:fe},null,8,["title","loading"])):v("",!0),m(t,{title:n(l)("dialog.close"),onClick:a[3]||(a[3]=e=>ce.value=!1)},null,8,["title"])])),default:y((()=>[["typeCreate","typeUpdate"].includes(n(pe))?(u(),k(S,{key:0,schema:J.formSchema,rules:W,ref_key:"typeFormRef",ref:de},{type:y((()=>["typeUpdate"==n(pe)?(u(),k(c,{key:0},{default:y((()=>[C(h(n(le)),1)])),_:1})):(u(),k(r,{key:1,modelValue:n(le),"onUpdate:modelValue":a[2]||(a[2]=e=>w(le)?le.value=e:null)},null,8,["modelValue"]))])),_:1},8,["schema","rules"])):v("",!0),["dataCreate","dataUpdate"].includes(n(pe))?(u(),k(S,{key:1,schema:B.formSchema,rules:G,ref_key:"dataFormRef",ref:ue},null,8,["schema","rules"])):v("",!0)])),_:1},8,["modelValue","title"])])}}}),[["__file","/Users/alex/Downloads/万界星空/产品研发/MES框架/dev/xiejinrun/new_open_mes_front/src/views/system/dict/index.vue"]]);export{se as default};
