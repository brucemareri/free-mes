import{d as e,e as a,f as l,g as o,o as t,c as s,k as d,w as u,a as r,j as n,F as i,n as p,G as c,X as m,t as f,J as v,ce as b,aK as g,aR as _,aH as y,H as k,Z as C,aq as h,aa as x,ab as V,v as w,aO as F,ac as j,ad as D,E as z,ae as S,A as U,B as N,a0 as G,_ as q}from"./index-4bfb878d.js";import{c as E}from"./index-529a6cde.js";import{c as O}from"./index-6c8a85ac.js";import{s as P,b as A,t as M,l as R,m as Y,n as B,o as H,r as J,v as K}from"./index-d5d2dc92.js";import{a as I,U as Q}from"./const-f443e30b.js";import{c as X}from"./pmOrder-563fbf59.js";import Z from"./index-fd066078.js";import L from"./index-4e987744.js";import"./index-6ebcd94a.js";import"./treeMaterial-9b585804.js";import"./materialData-d3bde0f1.js";import"./data-6c43379c.js";const T={style:{"margin-bottom":"20px"}},W={class:"dialog-footer"},$=q(e({__name:"index",setup(e){const q=a(),$=l({routeCode:[{required:!0,message:"工艺路线编号不能为空",trigger:"blur"}],routeName:[{required:!0,message:"工艺路线名称不能为空",trigger:"blur"}],enableFlag:[{required:!0,message:"是否启用不能为空",trigger:"blur"}]}),ee=l({routeCode:"",routeName:"",enableFlag:""});let ae=l({total:0,pageSize:10,pageSizes:[5,10,15,20],currentPage:1});const le=a(!1),oe=a(!1);let te=l([]),se=a(""),de=a([]),ue=a({routeCode:"",autoGenFlag:!1,routeName:"",enableFlag:"Y",routeDesc:"",remark:"",id:""});const re=a(!1),ne=()=>{ke()},ie=async()=>{const e=await R();b.excel(e,"工艺流程.xls")},pe=e=>{de.value=e.map((e=>null==e?void 0:e.id)),A[1].disabled=!de.value.length||de.value.length>=2,A[2].disabled=!de.value.length},ce=()=>{se.value="添加工艺路线",oe.value=!0},me=e=>{se.value="修改工艺路线";const a=(null==e?void 0:e.id)||de.value[0];be(a)},fe=e=>{const a=e||de.value,l=Array.isArray(a)?a:[a];g.confirm("是否删除当前数据?").then((()=>{Y(l).then((e=>{_.success("删除成功"),ke()}))}))},ve=e=>{re.value=!0,se.value="查看工艺路线",be(e)},be=e=>{B(e).then((e=>{ue.value=e,oe.value=!0}))},ge=e=>{ae=null==e?void 0:e.value,ke()},_e=async()=>{q.value&&await q.value.validate((e=>{e&&(ue.value.id?H(ue.value).then((e=>{_.success("修改成功"),ye(),ke()})):J(ue.value).then((e=>{_.success("新增成功"),ye(),ke()})))}))},ye=()=>{ue.value={routeCode:"",autoGenFlag:!1,routeName:"",enableFlag:"Y",routeDesc:"",remark:"",id:""},oe.value=!1,re.value=!1},ke=()=>{const e={...ee,pageNo:ae.currentPage,pageSize:ae.pageSize};le.value=!0,K(e).then((e=>{const{total:a,list:l=[]}=e||{};ae.total=a,te=l})).finally((()=>{le.value=!1}))};return o((()=>{ke()})),(e,a)=>{const l=k,o=C,b=h,g=x,_=V,R=w,Y=F,B=j,H=D,J=z,K=S,de=U,be=N,ke=G;return t(),s(i,null,[d(l,null,{default:u((()=>[d(E,{"conditions-list":r(P),"search-model":ee,onQueryData:ne},null,8,["conditions-list","search-model"])])),_:1}),d(l,null,{default:u((()=>[n("div",T,[(t(!0),s(i,null,p(r(A),((e,a)=>(t(),c(o,{plain:"",type:e.type,key:a,icon:e.icon,disabled:e.disabled,onClick:a=>(e=>{switch(e){case"save":ce();break;case"edit":me();break;case"remove":fe();break;case"download":ie()}})(e.state)},{default:u((()=>[m(f(e.label),1)])),_:2},1032,["type","icon","disabled","onClick"])))),128))]),d(O,{loading:le.value,isSelection:!0,columns:r(M),tableData:r(te),pagination:r(ae),onSelectionChange:pe,onPaginationChange:ge},{routeCode:u((({scope:e})=>[d(o,{link:"",type:"primary",onClick:a=>ve(e.row.id)},{default:u((()=>[m(f(e.row.routeCode),1)])),_:2},1032,["onClick"])])),enableFlag:u((({scope:e})=>[d(b,{type:"Y"===e.row.enableFlag?"success":"warning"},{default:u((()=>[m(f(r(I)[e.row.enableFlag]),1)])),_:2},1032,["type"])])),operation:u((({scope:e})=>[d(o,{style:{"font-size":"17px"},link:"",type:"primary",onClick:a=>ve(e.row.id)},{default:u((()=>[m("详情")])),_:2},1032,["onClick"]),d(o,{style:{"font-size":"17px"},link:"",type:"primary",onClick:a=>me(e.row)},{default:u((()=>[m("修改")])),_:2},1032,["onClick"]),d(o,{style:{"font-size":"17px"},link:"",type:"danger",onClick:a=>fe(e.row.id)},{default:u((()=>[m("删除")])),_:2},1032,["onClick"])])),_:1},8,["loading","columns","tableData","pagination"])])),_:1}),d(ke,{width:"50%",modelValue:oe.value,"onUpdate:modelValue":a[7]||(a[7]=e=>oe.value=e),title:r(se),onBeforeClose:ye},{footer:u((()=>[n("span",W,[re.value?v("",!0):(t(),c(o,{key:0,type:"primary",onClick:_e},{default:u((()=>[m("提交")])),_:1})),d(o,{onClick:ye},{default:u((()=>[m("返回")])),_:1})])])),default:u((()=>[d(K,{ref_key:"ruleFormRef",ref:q,model:r(ue),rules:$,"label-width":"100px"},{default:u((()=>[d(J,null,{default:u((()=>[d(R,{span:8},{default:u((()=>[d(_,{label:"工艺编号",prop:"routeCode"},{default:u((()=>[d(g,{disabled:re.value,modelValue:r(ue).routeCode,"onUpdate:modelValue":a[0]||(a[0]=e=>r(ue).routeCode=e),placeholder:"请输入工艺路线编号"},null,8,["disabled","modelValue"])])),_:1})])),_:1}),re.value?v("",!0):(t(),c(R,{key:0,span:8},{default:u((()=>[d(_,{label:"自动生成",prop:"autoGenFlag"},{default:u((()=>[d(Y,{modelValue:r(ue).autoGenFlag,"onUpdate:modelValue":a[1]||(a[1]=e=>r(ue).autoGenFlag=e),"active-color":"#13ce66",onChange:a[2]||(a[2]=e=>(e=>{if(!e)return;ue.value.routeCode="",X("PROCESS_CODE").then((e=>{y((()=>{ue.value.routeCode=e}))}))})(r(ue).autoGenFlag))},null,8,["modelValue"])])),_:1})])),_:1})),d(R,{span:8},{default:u((()=>[d(_,{label:"工艺名称",prop:"routeName"},{default:u((()=>[d(g,{disabled:re.value,modelValue:r(ue).routeName,"onUpdate:modelValue":a[3]||(a[3]=e=>r(ue).routeName=e),placeholder:"请输入工艺路线名称"},null,8,["disabled","modelValue"])])),_:1})])),_:1}),d(R,{span:8},{default:u((()=>[d(_,{label:"是否启用",prop:"enableFlag"},{default:u((()=>[d(H,{modelValue:r(ue).enableFlag,"onUpdate:modelValue":a[4]||(a[4]=e=>r(ue).enableFlag=e),disabled:re.value},{default:u((()=>[(t(!0),s(i,null,p(r(Q),((e,a)=>(t(),c(B,{label:e.value,key:a},{default:u((()=>[m(f(e.label),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1}),d(R,{span:8},{default:u((()=>[d(_,{label:"工艺说明",prop:"routeDesc"},{default:u((()=>[d(g,{autosize:"",disabled:re.value,modelValue:r(ue).routeDesc,"onUpdate:modelValue":a[5]||(a[5]=e=>r(ue).routeDesc=e),type:"textarea",placeholder:"请输入内容"},null,8,["disabled","modelValue"])])),_:1})])),_:1}),d(R,{span:8},{default:u((()=>[d(_,{label:"备注",prop:"remark"},{default:u((()=>[d(g,{autosize:"",disabled:re.value,modelValue:r(ue).remark,"onUpdate:modelValue":a[6]||(a[6]=e=>r(ue).remark=e),type:"textarea",placeholder:"请输入内容"},null,8,["disabled","modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"]),r(ue).id?(t(),c(be,{key:0,type:"border-card"},{default:u((()=>[d(de,{label:"组成工序"},{default:u((()=>[d(Z,{"process-id":r(ue).id,"is-edit":re.value},null,8,["process-id","is-edit"])])),_:1}),d(de,{label:"关联产品"},{default:u((()=>[d(L,{"process-id":r(ue).id,"is-edit":re.value},null,8,["process-id","is-edit"])])),_:1})])),_:1})):v("",!0)])),_:1},8,["modelValue","title"])],64)}}}),[["__file","/Users/alex/Downloads/万界星空/产品研发/MES框架/dev/xiejinrun/new_open_mes_front/src/views/prodMgmt/craftCourse/index.vue"]]);export{$ as default};
