import{f as e,d as a,e as l,g as o,o as s,c as t,k as d,w as r,a as n,j as i,F as p,n as u,G as c,X as m,t as b,J as k,z as w,aH as f,ce as g,aK as _,aR as h,aU as v,H as y,Z as C,aq as V,aa as F,ab as I,v as N,aO as x,E as j,at as U,au as z,ac as S,ad as A,ae as G,a0 as D,_ as q}from"./index-4bfb878d.js";import{c as O}from"./index-529a6cde.js";import{c as R}from"./index-6c8a85ac.js";import{a as E,U as H}from"./const-f443e30b.js";import P from"./workStationResources-d4f46766.js";import{e as Y,f as K,g as M,u as T,h as J,i as Q,j as W,k as X}from"./index-cbc4edd9.js";import{c as Z}from"./pmOrder-563fbf59.js";import"./carouselCard-f794a439.js";import"./tree-5260b4e2.js";const B=e([{type:"input",label:"工作站编码",prop:"workstationCode",placeholder:"请输入工作站编码"},{type:"input",label:"工作站名称",prop:"workstationName",placeholder:"请输入工作站名称"},{type:"select",label:"车间名称",prop:"workshopId",placeholder:"请选择车间",options:[]},{type:"select",label:"所属工序",prop:"processId",placeholder:"请选择工序",options:[]}]),L=[{prop:"workstationCode",label:"工作站编号",slot:"workstationCode"},{prop:"workstationName",label:"工作站名称"},{prop:"workstationAddress",label:"工作站地点"},{prop:"workshopName",label:"所在车间名称"},{prop:"processName",label:"所属工序"},{prop:"enableFlag",label:"是否启用",slot:"enableFlag"},{prop:"remark",label:"备注"},{label:"操作",slot:"operation",width:"130"}],$=e([{type:"primary",icon:"plus",state:"save",label:"新增",disabled:!1,permissions:[]},{type:"success",icon:"edit",state:"edit",label:"修改",disabled:!0,permissions:[]},{type:"danger",icon:"delete",state:"delete",label:"批量删除",disabled:!0,permissions:[]},{type:"warning",icon:"download",state:"download",label:"导出",permissions:[]}]),ee={style:{"margin-bottom":"20px"}},ae={class:"dialog-footer"},le=q(a({__name:"index",setup(a){const q=l(),le=e({workstationCode:"",workstationName:"",workshopId:"",processId:""});let oe=l([]);const se=e({total:0,pageSize:10,pageSizes:[5,10,15,20],currentPage:1});let te=e([]),de=l(!1),re=l(""),ne=l({workstationCode:"",autoGenFlag:!1,workstationName:"",workstationAddress:"",workshopId:"",processId:"",enableFlag:"Y",remark:"",id:""}),ie=e([]),pe=e([]);const ue=e({workstationCode:[{required:!0,message:"工作站编号不能为空",trigger:"blur"}],workstationName:[{required:!0,message:"工作站名称不能为空",trigger:"blur"}],workshopId:[{required:!0,message:"请选择所属车间",trigger:"blur"}],processId:[{required:!0,message:"请选择所属工序",trigger:"blur"}]}),ce=l(!1),me=l(!1),be=()=>{Ce()},ke=()=>{},we=async()=>{const e=await Y();g.excel(e,"工作站管理.xls")},fe=()=>{de.value=!0,re.value="新增工作站"},ge=e=>{let a=(null==e?void 0:e.id)?e.id:te[0];re.value="修改工作站",he(a)},_e=e=>{const a=(null==e?void 0:e.id)||te,l=Array.isArray(a)?a:[a];_.confirm("是否确认删除工作站？").then((()=>{K(l).then((e=>{h.success("删除成功"),Ce()}))}))},he=e=>{M(e).then((e=>{v(ne.value=e,e),de.value=!0}))},ve=async e=>{te=e.map((e=>e.id)),$[1].disabled=!te.length||te.length>=2,$[2].disabled=!te.length},ye=()=>{q.value&&(q.value.resetFields(),ne.value={workstationCode:"",autoGenFlag:!1,workstationName:"",workstationAddress:"",workshopId:"",processId:"",enableFlag:"Y",remark:"",id:""},de.value=!1,me.value=!1)},Ce=()=>{const e={...le,pageNo:se.currentPage,pageSize:se.pageSize};ce.value=!0,Q(e).then((e=>{const{list:a=[],total:l}=e||{};oe.value=a,se.total=l})).finally((()=>{ce.value=!1}))},Ve=()=>{Ce(),W().then((e=>{B[2].options=e.map((e=>({value:e.id,label:e.workshopName}))),ie=e})),X().then((e=>{B[3].options=e.map((e=>({value:e.id,label:e.processName}))),pe=e}))};return o((()=>{Ve()})),(e,a)=>{const l=y,o=C,g=V,_=F,v=I,Y=N,K=x,M=j,Q=U,W=z,X=S,te=A,Ve=G,Fe=D;return s(),t(p,null,[d(l,null,{default:r((()=>[d(O,{onQueryData:be,"conditions-list":n(B),"search-model":le},null,8,["conditions-list","search-model"])])),_:1}),d(l,null,{default:r((()=>[i("div",ee,[(s(!0),t(p,null,u(n($),((e,a)=>(s(),c(o,{plain:"",type:e.type,key:a,icon:e.icon,disabled:e.disabled,onClick:a=>(e=>{switch(e){case"save":fe();break;case"edit":ge();break;case"delete":_e();break;case"download":we()}})(e.state)},{default:r((()=>[m(b(e.label),1)])),_:2},1032,["type","icon","disabled","onClick"])))),128))]),d(R,{loading:n(ce),isSelection:!0,columns:n(L),tableData:n(oe),pagination:se,onSelectionChange:ve,onHandlePagination:ke},{workstationCode:r((({scope:e})=>[d(o,{link:"",type:"primary",onClick:a=>{return l=e.row,re.value="查看工作站详情",me.value=!0,void he(null==l?void 0:l.id);var l}},{default:r((()=>[m(b(e.row.workstationCode),1)])),_:2},1032,["onClick"])])),enableFlag:r((({scope:e})=>[d(g,{type:"Y"==e.row.enableFlag?"":"danger"},{default:r((()=>[m(b(n(E)[e.row.enableFlag]),1)])),_:2},1032,["type"])])),operation:r((({scope:e})=>[d(o,{style:{"font-size":"17px"},link:"",type:"primary",size:"small",onClick:a=>ge(e.row)},{default:r((()=>[m(" 修改 ")])),_:2},1032,["onClick"]),d(o,{style:{"font-size":"17px"},link:"",type:"danger",size:"small",onClick:a=>_e(e.row)},{default:r((()=>[m(" 删除 ")])),_:2},1032,["onClick"])])),_:1},8,["loading","columns","tableData","pagination"])])),_:1}),d(Fe,{modelValue:n(de),"onUpdate:modelValue":a[10]||(a[10]=e=>w(de)?de.value=e:de=e),title:n(re),width:"57%",onClose:ye},{footer:r((()=>[i("span",ae,[n(me)?k("",!0):(s(),c(o,{key:0,type:"primary",onClick:a[9]||(a[9]=e=>(async e=>{e&&await e.validate((e=>{e&&(ne.value.id?T(ne.value).then((e=>{e&&(h.success("修改成功"),ye(),Ce())})):J(ne.value).then((e=>{e&&(h.success("新增成功"),ye(),Ce())})))}))})(n(q)))},{default:r((()=>[m("提交")])),_:1})),d(o,{onClick:ye},{default:r((()=>[m("关闭")])),_:1})])])),default:r((()=>[d(Ve,{ref_key:"ruleFormRef",ref:q,model:n(ne),rules:ue,"status-icon":"","label-width":"120px"},{default:r((()=>[d(M,null,{default:r((()=>[d(Y,{span:8},{default:r((()=>[d(v,{label:"工作站编码",prop:"workstationCode"},{default:r((()=>[d(_,{modelValue:n(ne).workstationCode,"onUpdate:modelValue":a[0]||(a[0]=e=>n(ne).workstationCode=e),placeholder:"请输入工作站编码",clearable:"",disabled:n(me)},null,8,["modelValue","disabled"])])),_:1})])),_:1}),n(me)?k("",!0):(s(),c(Y,{key:0,span:8},{default:r((()=>[d(v,{prop:"autoGenFlag",label:"自动生成"},{default:r((()=>[d(K,{modelValue:n(ne).autoGenFlag,"onUpdate:modelValue":a[1]||(a[1]=e=>n(ne).autoGenFlag=e),"active-color":"#13ce66",onChange:a[2]||(a[2]=e=>(e=>{if(!e)return;ne.value.workstationCode="",Z("WORKSTATION_CODE").then((e=>{f((()=>{ne.value.workstationCode=e}))}))})(n(ne).autoGenFlag))},null,8,["modelValue"])])),_:1})])),_:1})),d(Y,{span:8},{default:r((()=>[d(v,{label:"工作站名称",prop:"workstationName"},{default:r((()=>[d(_,{disabled:n(me),modelValue:n(ne).workstationName,"onUpdate:modelValue":a[3]||(a[3]=e=>n(ne).workstationName=e),placeholder:"请输入工作站名称",clearable:""},null,8,["disabled","modelValue"])])),_:1})])),_:1})])),_:1}),d(M,null,{default:r((()=>[d(Y,{span:8},{default:r((()=>[d(v,{label:"工作站地点",prop:"workstationAddress"},{default:r((()=>[d(_,{disabled:n(me),modelValue:n(ne).workstationAddress,"onUpdate:modelValue":a[4]||(a[4]=e=>n(ne).workstationAddress=e),placeholder:"请输入工作站地点"},null,8,["disabled","modelValue"])])),_:1})])),_:1}),d(Y,{span:8},{default:r((()=>[d(v,{label:"所在车间",prop:"workshopId"},{default:r((()=>[d(W,{disabled:n(me),modelValue:n(ne).workshopId,"onUpdate:modelValue":a[5]||(a[5]=e=>n(ne).workshopId=e),placeholder:"请选择车间"},{default:r((()=>[(s(!0),t(p,null,u(n(ie),((e,a)=>(s(),c(Q,{key:a,label:e.workshopName,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["disabled","modelValue"])])),_:1})])),_:1}),d(Y,{span:8},{default:r((()=>[d(v,{label:"所属工序",prop:"processId"},{default:r((()=>[d(W,{disabled:n(me),modelValue:n(ne).processId,"onUpdate:modelValue":a[6]||(a[6]=e=>n(ne).processId=e),placeholder:"请选择工序"},{default:r((()=>[(s(!0),t(p,null,u(n(pe),((e,a)=>(s(),c(Q,{key:a,label:e.processName,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["disabled","modelValue"])])),_:1})])),_:1})])),_:1}),d(M,null,{default:r((()=>[d(Y,{span:8},{default:r((()=>[d(v,{label:"是否启用",prop:"enableFlag"},{default:r((()=>[d(te,{disabled:n(me),modelValue:n(ne).enableFlag,"onUpdate:modelValue":a[7]||(a[7]=e=>n(ne).enableFlag=e)},{default:r((()=>[(s(!0),t(p,null,u(n(H),((e,a)=>(s(),c(X,{label:e.value,key:a},{default:r((()=>[m(b(e.label),1)])),_:2},1032,["label"])))),128))])),_:1},8,["disabled","modelValue"])])),_:1})])),_:1}),d(Y,{span:8},{default:r((()=>[d(v,{label:"备注",prop:"remark"},{default:r((()=>[d(_,{disabled:n(me),modelValue:n(ne).remark,"onUpdate:modelValue":a[8]||(a[8]=e=>n(ne).remark=e),type:"textarea",autosize:"",placeholder:"备注",clearable:""},null,8,["disabled","modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"]),n(ne).id?(s(),c(P,{key:0,"is-edit":n(me),"work-id":n(ne).id},null,8,["is-edit","work-id"])):k("",!0)])),_:1},8,["modelValue","title"])],64)}}}),[["__file","/Users/alex/Downloads/万界星空/产品研发/MES框架/dev/xiejinrun/new_open_mes_front/src/views/masterData/workStationManage/index.vue"]]);export{le as default};
