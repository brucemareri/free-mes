import{f as e,d as a,e as l,g as t,o as s,c as o,k as d,w as u,a as r,j as i,F as n,n as p,G as m,X as c,t as v,J as b,aR as y,aK as g,H as f,Z as _,aa as h,ab as k,v as C,aO as V,cb as w,E as x,ae as N,a0 as T,ce as D,_ as U}from"./index-4bfb878d.js";import{c as Y}from"./index-529a6cde.js";import{c as S}from"./index-6c8a85ac.js";import{g as j,u as z,s as H,d as M,a as q,e as P,b as A}from"./classType-375ef761.js";const E=e([{type:"select",label:"类型名称",prop:"typeName",placeholder:"请选择类型名称",options:[]},{type:"input",label:"创建人员",prop:"creator",placeholder:"请输入创建人员"},{type:"date",label:"创建时间",prop:"createTime",placeholder:"请选择创建时间"}]),F=e([{type:"primary",icon:"plus",state:"save",label:"新增",disabled:!1,permissions:[]},{type:"success",icon:"edit",state:"edit",label:"修改",disabled:!0,permissions:[]},{type:"danger",icon:"delete",state:"remove",label:"批量删除",disabled:!0,permissions:[]},{type:"warning",icon:"download",state:"download",label:"导出",disabled:!1,permissions:[]}]),R=[{label:"类型编号",prop:"typeCode"},{label:"类型名称",prop:"typeName"},{label:"创建时间",prop:"createTime",width:"170"},{label:"创建人员",prop:"creator"},{label:"备注",prop:"remark"},{label:"操作",slot:"operate",width:"230",fixed:"right"}],G={style:{"margin-bottom":"20px"}},J=U(a({__name:"index",setup(a){const U=l(),J=l({typeCode:{required:!0,message:"班组编号不能为空格",trigger:"blur"},typeName:{required:!0,message:"班组类型不能为空格",trigger:"blur"},creator:{required:!0,message:"创建人员不能为空格",trigger:"blur"},createTime:{required:!0,message:"创建时间不能为空格",trigger:"blur"}}),K=l({typeCode:"",generate:!1,typeName:"",createTime:"",creator:"",remark:""}),O=e({typeName:"",creator:"",createTime:""}),Q=l([]);let X=e({total:0,pageSize:10,pageSizes:[5,10,15,20],currentPage:1});const Z=l(!1),B=l(!1),I=l(""),L=l(!1),W=e=>{e&&j().then((e=>{K.value.typeCode=e}))},$=()=>{U.value&&U.value.validate((e=>{var a;e&&((null==(a=K.value)?void 0:a.id)?z(K.value).then((e=>{e&&(y({message:"修改成功",type:"success"}),re(),ie())})):H(K.value).then((e=>{e&&(y({message:"新增成功",type:"success"}),re(),ie())})))}))},ee=()=>{ie()},ae=l(),le=e=>{ae.value=e.map((e=>null==e?void 0:e.id)),F[1].disabled=!ae.value.length||ae.value.length>=2,F[2].disabled=!ae.value.length},te=e=>{X=null==e?void 0:e.value,ie()},se=e=>{switch(e){case"save":oe();break;case"edit":de();break;case"remove":ue();break;case"download":(async()=>{const e=await P();D.excel(e,"班组类型.xls")})()}},oe=()=>{I.value="添加班组类型",B.value=!0},de=e=>{I.value="修改班组类型";(e=>new Promise(((a,l)=>{A(e).then((e=>{a(e)}))})))(e?e.id:ae.value[0]).then((e=>{K.value=e,B.value=!0}))},ue=e=>{const a=(null==e?void 0:e.id)||ae.value,l=Array.isArray(a)?a:[a];g.confirm("是否删除当前数据?").then((()=>{M(l).then((e=>{y.success("删除成功"),ie()}))}))},re=()=>{K.value={typeCode:"",generate:!1,typeName:"",createTime:"",creator:"",remark:""},L.value=!1,B.value=!1},ie=()=>{Z.value=!0;const e={...O,pageSize:X.pageSize,pageNo:X.currentPage};q(e).then((e=>{const{list:a,total:l}=e||{};E[0].options=a.map((e=>({value:e.typeName,label:e.typeName}))),Q.value=a,X.total=l})).finally((()=>{Z.value=!1}))};return t((()=>{ie()})),(e,a)=>{const l=f,t=_,y=h,g=k,D=C,j=V,z=w,H=x,M=N,q=T;return s(),o(n,null,[d(l,null,{default:u((()=>[d(Y,{"conditions-list":r(E),"search-model":O,onQueryData:ee},null,8,["conditions-list","search-model"])])),_:1}),d(l,null,{default:u((()=>[i("div",G,[(s(!0),o(n,null,p(r(F),((e,a)=>(s(),m(t,{plain:"",type:e.type,key:a,icon:e.icon,disabled:e.disabled,onClick:a=>se(e.state)},{default:u((()=>[c(v(e.label),1)])),_:2},1032,["type","icon","disabled","onClick"])))),128))]),d(S,{loading:Z.value,isSelection:!0,columns:r(R),tableData:Q.value,pagination:r(X),onSelectionChange:le,onPaginationChange:te},{operate:u((({scope:e})=>[d(t,{type:"primary",onClick:a=>{return l=e.row,I.value="查看班组类型",K.value=l,L.value=!0,void(B.value=!0);var l}},{default:u((()=>[c("详情")])),_:2},1032,["onClick"]),d(t,{type:"success",onClick:a=>de(e.row)},{default:u((()=>[c("修改")])),_:2},1032,["onClick"]),d(t,{type:"danger",onClick:a=>ue(e.row)},{default:u((()=>[c("删除")])),_:2},1032,["onClick"])])),_:1},8,["loading","columns","tableData","pagination"])])),_:1}),d(q,{modelValue:B.value,"onUpdate:modelValue":a[6]||(a[6]=e=>B.value=e),title:I.value,width:"60%",onClose:re},{footer:u((()=>[L.value?b("",!0):(s(),m(t,{key:0,type:"primary",onClick:$},{default:u((()=>[c("确定")])),_:1})),d(t,{onClick:re},{default:u((()=>[c("取消")])),_:1})])),default:u((()=>[d(M,{"label-width":"100px",ref_key:"ruleFormRef",ref:U,model:K.value,rules:J.value,"status-icon":""},{default:u((()=>[d(H,null,{default:u((()=>[d(D,{span:8},{default:u((()=>[d(g,{label:"类型编号",prop:"typeCode"},{default:u((()=>[d(y,{modelValue:K.value.typeCode,"onUpdate:modelValue":a[0]||(a[0]=e=>K.value.typeCode=e),disabled:L.value||K.value.id},null,8,["modelValue","disabled"])])),_:1})])),_:1}),c(" "+v()+" ",1),L.value||K.value.id?b("",!0):(s(),m(D,{key:0,span:8},{default:u((()=>[d(g,{label:"自动生成",prop:"generate"},{default:u((()=>[d(j,{modelValue:K.value.generate,"onUpdate:modelValue":a[1]||(a[1]=e=>K.value.generate=e),onChange:W},null,8,["modelValue"])])),_:1})])),_:1})),d(D,{span:8},{default:u((()=>[d(g,{label:"类型名称",prop:"typeName"},{default:u((()=>[d(y,{modelValue:K.value.typeName,"onUpdate:modelValue":a[2]||(a[2]=e=>K.value.typeName=e),disabled:L.value},null,8,["modelValue","disabled"])])),_:1})])),_:1}),d(D,{span:8},{default:u((()=>[d(g,{label:"创建人员",prop:"creator"},{default:u((()=>[d(y,{modelValue:K.value.creator,"onUpdate:modelValue":a[3]||(a[3]=e=>K.value.creator=e),disabled:L.value},null,8,["modelValue","disabled"])])),_:1})])),_:1}),d(D,{span:8},{default:u((()=>[d(g,{label:"创建时间",prop:"createTime"},{default:u((()=>[d(z,{disabled:L.value,modelValue:K.value.createTime,"onUpdate:modelValue":a[4]||(a[4]=e=>K.value.createTime=e),type:"datetime",placeholder:"请选择创建时间",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss","default-time":new Date},null,8,["disabled","modelValue","default-time"])])),_:1})])),_:1}),d(D,{span:8},{default:u((()=>[d(g,{label:"备注",prop:"remark"},{default:u((()=>[d(y,{disabled:L.value,modelValue:K.value.remark,"onUpdate:modelValue":a[5]||(a[5]=e=>K.value.remark=e),type:"textarea",autosize:""},null,8,["disabled","modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])],64)}}}),[["__file","/Users/alex/Downloads/万界星空/产品研发/MES框架/dev/xiejinrun/new_open_mes_front/src/views/scheduling/classType/index.vue"]]);export{J as default};
