import{q as e,f as a,d as t,K as l,e as i,C as s,o,c as n,k as r,w as c,a as u,I as d,G as m,J as f,z as p,F as v,L as y,M as g,N as k,H as w,aJ as C,a1 as _,a0 as S,_ as h}from"./index-4bfb878d.js";import{g as x,d as j,a as I,c as b,u as R}from"./index-1e8b251d.js";import{r as T}from"./formRules-eb36c657.js";import{u as V}from"./useVxeCrudSchemas-092b8963.js";import{u as D}from"./useXTable-309dffed.js";const{t:q}=e(),F=a({name:[T],url:[T],username:[T],password:[T]}),L=a({primaryKey:"id",primaryType:"seq",action:!0,columns:[{title:"数据源名称",field:"name"},{title:"数据源连接",field:"url",form:{component:"Input",componentProps:{type:"textarea",rows:4},colProps:{span:24}}},{title:"用户名",field:"username"},{title:"密码",field:"password",isTable:!1},{title:q("common.createTime"),field:"createTime",formatter:"formatDate",isForm:!1}]}),{allSchemas:M}=V(L),P=t({name:"DataSourceConfig"}),z=h(t({...P,setup(a){const{t:t}=e(),h=l(),[T,{reload:V,deleteData:q}]=D({allSchemas:M,isList:!0,getListApi:x,deleteApi:j}),L=i(!1),P=i(""),z=i(!1),A=i("edit"),E=i(),J=i(),K=e=>{A.value=t("action."+e),P.value=e,z.value=!0};return(e,a)=>{const l=y,i=g,x=k,j=w,D=C,U=_,G=S,H=s("hasPermi");return o(),n(v,null,[r(j,null,{default:c((()=>[r(x,{onRegister:u(T)},{toolbar_buttons:c((()=>[d(r(l,{type:"primary",preIcon:"ep:zoom-in",title:u(t)("action.add"),onClick:a[0]||(a[0]=e=>{K("create")})},null,8,["title"]),[[H,["infra:data-source-config:create"]]])])),actionbtns_default:c((({row:e})=>[d(r(i,{preIcon:"ep:edit",title:u(t)("action.edit"),onClick:a=>(async e=>{var a;K("update");const t=await I(e);null==(a=u(E))||a.setValues(t)})(e.id)},null,8,["title","onClick"]),[[H,["infra:data-source-config:update"]]]),d(r(i,{preIcon:"ep:view",title:u(t)("action.detail"),onClick:a=>(async e=>{const a=await I(e);J.value=a,K("detail")})(e.id)},null,8,["title","onClick"]),[[H,["infra:data-source-config:query"]]]),d(r(i,{preIcon:"ep:delete",title:u(t)("action.del"),onClick:a=>u(q)(e.id)},null,8,["title","onClick"]),[[H,["infra:data-source-config:delete"]]])])),_:1},8,["onRegister"])])),_:1}),r(G,{modelValue:u(z),"onUpdate:modelValue":a[3]||(a[3]=e=>p(z)?z.value=e:null),title:u(A)},{footer:c((()=>[["create","update"].includes(u(P))?(o(),m(l,{key:0,type:"primary",title:u(t)("action.save"),loading:u(L),onClick:a[1]||(a[1]=e=>(async()=>{var e;const a=null==(e=u(E))?void 0:e.getElFormRef();a&&a.validate((async e=>{var a;if(e){L.value=!0;try{const e=null==(a=u(E))?void 0:a.formModel;"create"===P.value?(await b(e),h.success(t("common.createSuccess"))):(await R(e),h.success(t("common.updateSuccess"))),z.value=!1}finally{L.value=!1,await V()}}}))})())},null,8,["title","loading"])):f("",!0),r(l,{loading:u(L),title:u(t)("dialog.close"),onClick:a[2]||(a[2]=e=>z.value=!1)},null,8,["loading","title"])])),default:c((()=>[["create","update"].includes(u(P))?(o(),m(D,{key:0,schema:u(M).formSchema,rules:u(F),ref_key:"formRef",ref:E},null,8,["schema","rules"])):f("",!0),"detail"===u(P)?(o(),m(U,{key:1,schema:u(M).detailSchema,data:u(J)},null,8,["schema","data"])):f("",!0)])),_:1},8,["modelValue","title"])],64)}}}),[["__file","/Users/alex/Downloads/万界星空/产品研发/MES框架/dev/xiejinrun/new_open_mes_front/src/views/infra/dataSourceConfig/index.vue"]]);export{z as default};
