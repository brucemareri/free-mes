import{f as e,D as a,d as s,u as l,e as t,a6 as o,o as i,G as r,w as n,a as u,c as p,k as d,X as c,t as f,J as m,j as v,z as y,ao as _,K as b,ap as x,aq as g,M as C,N as w,L as h,v as j,l as k,H as S,_ as M}from"./index-4bfb878d.js";import{u as T}from"./useVxeCrudSchemas-092b8963.js";import{b as D,a as E}from"./index-d0a64031.js";import{c as L}from"./index-ca7d0818.js";import{b as I}from"./formCreate-a3356cdc.js";import{u as O}from"./useXTable-309dffed.js";const P=e({primaryKey:"id",primaryType:null,action:!0,columns:[{title:"流程名称",field:"name"},{title:"流程分类",field:"category",dictType:a.BPM_MODEL_CATEGORY,dictClass:"number",table:{slots:{default:"category_default"}}},{title:"流程版本",field:"version",table:{slots:{default:"version_default"}}},{title:"流程描述",field:"description"}]}),{allSchemas:R}=T(P),V={key:0},A={key:1},G={class:"clearfix"},U={class:"el-icon-document"},B=v("div",{class:"clearfix"},[v("span",{class:"el-icon-picture-outline"},"流程图")],-1),K=M(s({__name:"create",setup(e){const s=l(),M=b(),[T]=O({allSchemas:R,params:{suspensionState:1},getListApi:D,isList:!0}),P=t(),K=t({rule:[],option:{}}),N=t(),X=async e=>{if(P.value&&N.value){P.value.btn.loading(!0);try{await L({processDefinitionId:N.value.id,variables:e}),M.success("发起流程成功"),s.go(-1)}finally{P.value.btn.loading(!1)}}},Y=t(null),q=t({prefix:"flowable"});return(e,l)=>{const t=x,b=g,M=C,D=w,L=h,O=o("form-create"),R=j,z=k,F=o("my-process-viewer"),H=S;return i(),r(H,null,{default:n((()=>[u(N)?(i(),p("div",A,[d(z,{class:"box-card"},{default:n((()=>[v("div",G,[v("span",U,"申请信息【"+f(u(N).name)+"】",1),d(L,{style:{float:"right"},type:"primary",preIcon:"ep:delete",title:"选择其它流程",onClick:l[0]||(l[0]=e=>N.value=void 0)})]),d(R,{span:16,offset:6,style:{"margin-top":"20px"}},{default:n((()=>[d(O,{rule:u(K).rule,api:u(P),"onUpdate:api":l[1]||(l[1]=e=>y(P)?P.value=e:null),option:u(K).option,onSubmit:X},null,8,["rule","api","option"])])),_:1})])),_:1}),d(z,{class:"box-card"},{default:n((()=>[B,d(F,_({key:"designer",modelValue:u(Y),"onUpdate:modelValue":l[2]||(l[2]=e=>y(Y)?Y.value=e:null),value:u(Y)},u(q),{prefix:u(q).prefix}),null,16,["modelValue","value","prefix"])])),_:1})])):(i(),p("div",V,[d(D,{onRegister:u(T)},{category_default:n((({row:e})=>[d(t,{type:u(a).BPM_MODEL_CATEGORY,value:Number(null==e?void 0:e.category)},null,8,["type","value"])])),version_default:n((({row:e})=>[e?(i(),r(b,{key:0},{default:n((()=>[c("v"+f(e.version),1)])),_:2},1024)):m("",!0)])),actionbtns_default:n((({row:e})=>[d(M,{preIcon:"ep:plus",title:"选择",onClick:a=>(async e=>{N.value=e,10==e.formType?(I(K,e.formConf,e.formFields),E(e.id).then((e=>{Y.value=e}))):e.formCustomCreatePath&&await s.push({path:e.formCustomCreatePath})})(e)},null,8,["onClick"])])),_:1},8,["onRegister"])]))])),_:1})}}}),[["__file","/Users/alex/Downloads/万界星空/产品研发/MES框架/dev/xiejinrun/new_open_mes_front/src/views/bpm/processInstance/create.vue"]]);export{K as default};
