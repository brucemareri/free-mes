import{d as e,$ as a,e as l,f as t,g as s,a6 as o,o as r,G as u,w as i,H as n,k as d,a as m,c,j as p,t as f,J as v,z as y,n as _,X as g,a7 as k,D as V,F as b,q as h,K as w,a8 as x,L as C,M as S,a9 as j,aa as O,ab as U,ac as E,ad as N,ae as q,a0 as M,_ as D}from"./index-4bfb878d.js";import{_ as J}from"./Dialog-da8c6c8d.js";import{C as A}from"./constants-97c4dd5f.js";import{g as B,c as F,u as H}from"./index-cfea5fec.js";import{s as L,e as R,a as T}from"./formCreate-a3356cdc.js";const z={key:0,ref:"editor"},G=e({name:"BpmFormEditor"}),K=D(e({...G,setup(e){const{t:D}=h(),G=w(),{query:K}=a(),P=l(),X=l(-1),$=l(""),I=l(""),Q=l(!1),W=l(!1),Y=l(!1),Z=l(),ee=t({name:[{required:!0,message:"表单名不能为空",trigger:"blur"}],status:[{required:!0,message:"开启状态不能为空",trigger:"blur"}]}),ae=l({name:"",status:A.ENABLE,remark:""}),le=()=>{Q.value=!0},te=async()=>{const e=m(Z);if(!e)return;if(await e.validate()){Y.value=!0;try{const e=ae.value;e.conf=R(P),e.fields=T(P),e.id?(await H(e),G.success(D("common.updateSuccess"))):(await F(e),G.success(D("common.createSuccess"))),Q.value=!1}finally{Y.value=!1}}},se=()=>{re("生成JSON"),X.value=0,$.value=P.value.getRule()},oe=()=>{re("生成Options"),X.value=1,$.value=P.value.getOption()},re=e=>{W.value=!0,I.value=e};return s((()=>{const e=K.id;e&&B(e).then((e=>{ae.value=e,L(P,e.conf,e.fields)}))})),(e,a)=>{const l=C,t=o("fc-designer"),s=S,h=j,w=J,A=O,B=U,F=E,H=N,L=q,R=M,T=n;return r(),u(T,null,{default:i((()=>[d(t,{ref_key:"designer",ref:P,height:"780px"},{handle:i((()=>[d(l,{type:"primary",title:"生成JSON",onClick:se}),d(l,{type:"primary",title:"生成Options",onClick:oe}),d(l,{type:"primary",title:m(D)("action.save"),onClick:le},null,8,["title"])])),_:1},512),d(w,{title:m(I),modelValue:m(W),"onUpdate:modelValue":a[1]||(a[1]=e=>y(W)?W.value=e:null),maxHeight:"600"},{default:i((()=>[m(W)?(r(),c("div",z,[d(s,{style:{float:"right"},title:m(D)("common.copy"),onClick:a[0]||(a[0]=e=>(async e=>{const{copy:a,copied:l,isSupported:t}=x({source:e});t?(await a(),m(l)&&G.success(D("common.copySuccess"))):G.error(D("common.copyError"))})(m($)))},null,8,["title"]),d(h,{height:"580"},{default:i((()=>[p("pre",null,"            "+f(m($))+"\n          ",1)])),_:1})],512)):v("",!0)])),_:1},8,["title","modelValue"]),d(R,{modelValue:m(Q),"onUpdate:modelValue":a[6]||(a[6]=e=>y(Q)?Q.value=e:null),title:"保存表单"},{footer:i((()=>[d(l,{type:"primary",title:m(D)("action.save"),loading:m(Y),onClick:te},null,8,["title","loading"]),d(l,{title:m(D)("dialog.close"),onClick:a[5]||(a[5]=e=>Q.value=!1)},null,8,["title"])])),default:i((()=>[d(L,{ref_key:"formRef",ref:Z,model:m(ae),rules:m(ee),"label-width":"80px"},{default:i((()=>[d(B,{label:"表单名",prop:"name"},{default:i((()=>[d(A,{modelValue:m(ae).name,"onUpdate:modelValue":a[2]||(a[2]=e=>m(ae).name=e),placeholder:"请输入表单名"},null,8,["modelValue"])])),_:1}),d(B,{label:"开启状态",prop:"status"},{default:i((()=>[d(H,{modelValue:m(ae).status,"onUpdate:modelValue":a[3]||(a[3]=e=>m(ae).status=e)},{default:i((()=>[(r(!0),c(b,null,_(m(k)(m(V).COMMON_STATUS),(e=>(r(),u(F,{key:e.value,label:e.value},{default:i((()=>[g(f(e.label),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1}),d(B,{label:"备注",prop:"remark"},{default:i((()=>[d(A,{modelValue:m(ae).remark,"onUpdate:modelValue":a[4]||(a[4]=e=>m(ae).remark=e),type:"textarea",placeholder:"请输入备注"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])),_:1})}}}),[["__file","/Users/alex/Downloads/万界星空/产品研发/MES框架/dev/xiejinrun/new_open_mes_front/src/views/bpm/form/formEditor.vue"]]);export{K as default};
