import{f as a,r as e,d as l,e as t,g as s,o as n,c as i,k as u,w as o,a as d,j as r,F as m,n as p,G as c,X as v,t as y,aK as b,aR as f,H as g,Z as h,aa as _,ab as k,v as w,E as N,ae as x,a0 as V,_ as S}from"./index-4bfb878d.js";import{c as C}from"./index-529a6cde.js";import{c as j}from"./index-6c8a85ac.js";const z=a([{type:"select",label:"状态类型",prop:"statusName",placeholder:"选择状态类型",options:[]}]),D=a([{type:"primary",icon:"plus",state:"save",label:"新增",disabled:!1,permissions:[]},{type:"success",icon:"edit",state:"edit",label:"修改",disabled:!0,permissions:[]},{type:"danger",icon:"delete",state:"remove",label:"批量删除",disabled:!0,permissions:[]}]),U=[{label:"状态编码",prop:"id"},{prop:"statusName",label:"设备状态"},{prop:"createTime",label:"创建时间"},{prop:"remark",label:"备注"}],P={style:{"margin-bottom":"20px"}},q={class:"dialog-footer"},A=S(l({__name:"index",setup(l){const S=t(),A=a({statusName:[{required:!0,message:"状态类型不能为空",trigger:"blur"}]}),E=a({statusName:""});let F=a({total:0,pageSize:10,pageSizes:[5,10,15,20],currentPage:1});const M=t(!1),R=t(!1);let T=a([]),B=t(""),G=t([]),H=t({statusName:"",remark:"",id:""}),K=t([]);const Q=()=>{Y()},X=a=>{G.value=a.map((a=>null==a?void 0:a.id)),D[1].disabled=!G.value.length||G.value.length>=2,D[2].disabled=!G.value.length},Z=()=>{B.value="添加状态类型",R.value=!0},$=()=>{B.value="修改状态类型";const a=G.value[0];I(a)},I=a=>{(async a=>await e.get({url:`/admin-api/mes/dv/machinery/status/get/${a}`}))(a).then((a=>{H.value=a,R.value=!0}))},J=a=>{const l=G.value,t=Array.isArray(l)?l:[l];b.confirm("是否删除当前数据?").then((()=>{(async a=>await e.delete({url:"/admin-api/mes/dv/machinery/status/batch",data:a}))(t).then((a=>{f.success("删除成功"),Y()}))}))},L=a=>{F=null==a?void 0:a.value,Y()},O=async()=>{S.value&&await S.value.validate((a=>{a&&(H.value.id?(async a=>await e.put({url:"/admin-api/mes/dv/machinery/status/update",data:a}))(H.value).then((a=>{f.success("修改成功"),W(),Y()})):(async a=>await e.post({url:"/admin-api/mes/dv/machinery/status/save",data:a}))(H.value).then((a=>{f.success("新增成功"),W(),Y()})))}))},W=()=>{H.value={statusName:"",remark:"",id:""},R.value=!1},Y=()=>{const a={...E,pageNo:F.currentPage,pageSize:F.pageSize};M.value=!0,(async a=>await e.get({url:"/admin-api/mes/dv/machinery/status/list",params:a}))(a).then((a=>{const{total:e,list:l=[]}=a||{};F.total=e,T=l,K.value=l.map((a=>({label:a.statusName,value:a.statusName}))),z[0].options=K.value})).finally((()=>{M.value=!1}))};return s((()=>{Y()})),(a,e)=>{const l=g,t=h,s=_,b=k,f=w,G=N,K=x,I=V;return n(),i(m,null,[u(l,null,{default:o((()=>[u(C,{"conditions-list":d(z),"search-model":E,onQueryData:Q},null,8,["conditions-list","search-model"])])),_:1}),u(l,null,{default:o((()=>[r("div",P,[(n(!0),i(m,null,p(d(D),((a,e)=>(n(),c(t,{plain:"",type:a.type,key:e,icon:a.icon,disabled:a.disabled,onClick:e=>(a=>{switch(a){case"save":Z();break;case"edit":$();break;case"remove":J()}})(a.state)},{default:o((()=>[v(y(a.label),1)])),_:2},1032,["type","icon","disabled","onClick"])))),128))]),u(j,{loading:M.value,isSelection:!0,columns:d(U),tableData:d(T),pagination:d(F),onSelectionChange:X,onPaginationChange:L},null,8,["loading","columns","tableData","pagination"])])),_:1}),u(I,{width:"40%",modelValue:R.value,"onUpdate:modelValue":e[2]||(e[2]=a=>R.value=a),title:d(B),onBeforeClose:W},{footer:o((()=>[r("span",q,[u(t,{type:"primary",onClick:O},{default:o((()=>[v(" 提交 ")])),_:1}),u(t,{onClick:W},{default:o((()=>[v("返回")])),_:1})])])),default:o((()=>[u(K,{ref_key:"ruleFormRef",ref:S,model:d(H),rules:A,"label-width":"140px"},{default:o((()=>[u(G,null,{default:o((()=>[u(f,{span:19},{default:o((()=>[u(b,{label:"状态类型",prop:"statusName"},{default:o((()=>[u(s,{modelValue:d(H).statusName,"onUpdate:modelValue":e[0]||(e[0]=a=>d(H).statusName=a)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),u(G,null,{default:o((()=>[u(f,{span:19},{default:o((()=>[u(b,{label:"备注",prop:"remark"},{default:o((()=>[u(s,{modelValue:d(H).remark,"onUpdate:modelValue":e[1]||(e[1]=a=>d(H).remark=a),type:"textarea",placeholder:"请输入内容"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])],64)}}}),[["__file","/Users/alex/Downloads/万界星空/产品研发/MES框架/dev/xiejinrun/new_open_mes_front/src/views/equipmentManage/storeStateType/index.vue"]]);export{A as default};
