import{f as e,r as a,d as l,e as o,g as s,o as t,c as d,k as n,w as r,a as u,j as i,F as p,n as c,G as m,X as b,t as v,J as f,ce as g,aK as _,aR as y,aH as V,H as h,Z as k,aq as C,aa as w,ab as F,v as x,aO as N,E as U,ac as Y,ad as S,cb as D,ae as j,a0 as q,_ as T}from"./index-4bfb878d.js";import{c as G}from"./index-529a6cde.js";import{c as M}from"./index-6c8a85ac.js";import{U as z,a as E}from"./const-f443e30b.js";import{c as I}from"./pmOrder-563fbf59.js";const O=e([{type:"input",label:"工序编码",prop:"processCode",placeholder:"请输入工序编码"},{type:"input",label:"工序名称",prop:"processName",placeholder:"请输入工序名称"},{type:"select",label:"是否启用",prop:"enableFlag",placeholder:"是否启用",options:z}]),P=e([{type:"primary",icon:"plus",state:"save",label:"新增",disabled:!1,permissions:[]},{type:"success",icon:"edit",state:"edit",label:"修改",disabled:!0,permissions:[]},{type:"danger",icon:"delete",state:"remove",label:"批量删除",disabled:!0,permissions:[]},{type:"warning",icon:"download",state:"download",label:"导出",permissions:[]}]),R=[{label:"工序编码",slot:"processCode"},{prop:"processName",label:"工序名称"},{label:"是否启用",slot:"enableFlag"},{prop:"remark",label:"备注"},{label:"操作",slot:"operation",width:"120",fixed:"right"}],A={style:{"margin-bottom":"20px"}},H={class:"dialog-footer"},B=T(l({__name:"index",setup(l){const T=o(),B=e({processCode:[{required:!0,message:"工序编码不能为空",trigger:"blur"}],processName:[{required:!0,message:"工序名称不能为空",trigger:"blur"}],enableFlag:[{required:!0,message:"是否启用不能为空",trigger:"blur"}]}),J=e({processCode:"",processName:"",enableFlag:""});let K=e({total:0,pageSize:10,pageSizes:[5,10,15,20],currentPage:1});const Q=o(!1),X=o(!1);let Z=e([]),$=o(""),L=o([]),W=o({processCode:"",processName:"",enableFlag:"Y",autoGenFlag:!1,attention:"",remark:"",preparationTime:"",productiveTime:"",qualityInspection:"N",id:""});const ee=()=>{pe()},ae=async()=>{const e=await(async()=>await a.download({url:"/admin-api/mes/pro/process/export"}))();g.excel(e,"工序设置.xls")},le=e=>{L.value=e.map((e=>null==e?void 0:e.id)),P[1].disabled=!L.value.length||L.value.length>=2,P[2].disabled=!L.value.length},oe=()=>{$.value="添加生产工序",X.value=!0},se=e=>{$.value="修改生产工序";const a=(null==e?void 0:e.id)||L.value[0];ne(a)},te=e=>{const l=e||L.value,o=Array.isArray(l)?l:[l];_.confirm("是否删除当前数据?").then((()=>{(async e=>await a.delete({url:"/admin-api/mes/pro/process/batch",data:e}))(o).then((e=>{y.success("删除成功"),pe()}))}))},de=o(!1),ne=e=>{(async e=>await a.get({url:`/admin-api/mes/pro/process/get/${e}`}))(e).then((e=>{W.value=e,X.value=!0}))},re=e=>{K=null==e?void 0:e.value,pe()},ue=async()=>{T.value&&await T.value.validate((e=>{e&&(W.value.id?(async e=>await a.put({url:"/admin-api/mes/pro/process/update",data:e}))(W.value).then((e=>{y.success("修改成功"),ie(),pe()})):(async e=>await a.post({url:"/admin-api/mes/pro/process/save",data:e}))(W.value).then((e=>{y.success("新增成功"),ie(),pe()})))}))},ie=()=>{W.value={processCode:"",processName:"",enableFlag:"Y",autoGenFlag:!1,attention:"",remark:"",id:""},de.value=!1,X.value=!1},pe=()=>{const e={...J,pageNo:K.currentPage,pageSize:K.pageSize};Q.value=!0,(async e=>await a.get({url:"/admin-api/mes/pro/process/list",params:e}))(e).then((e=>{const{total:a,list:l=[]}=e||{};K.total=a,Z=l})).finally((()=>{Q.value=!1}))};return s((()=>{pe()})),(e,a)=>{const l=h,o=k,s=C,g=w,_=F,y=x,L=N,pe=U,ce=Y,me=S,be=D,ve=j,fe=q;return t(),d(p,null,[n(l,null,{default:r((()=>[n(G,{"conditions-list":u(O),"search-model":J,onQueryData:ee},null,8,["conditions-list","search-model"])])),_:1}),n(l,null,{default:r((()=>[i("div",A,[(t(!0),d(p,null,c(u(P),((e,a)=>(t(),m(o,{plain:"",type:e.type,key:a,icon:e.icon,disabled:e.disabled,onClick:a=>(e=>{switch(e){case"save":oe();break;case"edit":se();break;case"remove":te();break;case"download":ae()}})(e.state)},{default:r((()=>[b(v(e.label),1)])),_:2},1032,["type","icon","disabled","onClick"])))),128))]),n(M,{loading:Q.value,isSelection:!0,columns:u(R),tableData:u(Z),pagination:u(K),onSelectionChange:le,onPaginationChange:re},{processCode:r((({scope:e})=>[n(o,{link:"",type:"primary",onClick:a=>{return l=e.row.id,$.value="查看生产工序",de.value=!0,void ne(l);var l}},{default:r((()=>[b(v(e.row.processCode),1)])),_:2},1032,["onClick"])])),enableFlag:r((({scope:e})=>[n(s,{type:"Y"===e.row.enableFlag?"success":"warning"},{default:r((()=>[b(v(u(E)[e.row.enableFlag]),1)])),_:2},1032,["type"])])),operation:r((({scope:e})=>[n(o,{link:"",type:"primary",onClick:a=>se(e.row)},{default:r((()=>[b("修改")])),_:2},1032,["onClick"]),n(o,{link:"",type:"danger",onClick:a=>te(e.row.id)},{default:r((()=>[b("删除")])),_:2},1032,["onClick"])])),_:1},8,["loading","columns","tableData","pagination"])])),_:1}),n(fe,{width:"65%",modelValue:X.value,"onUpdate:modelValue":a[11]||(a[11]=e=>X.value=e),title:u($),onBeforeClose:ie},{footer:r((()=>[i("span",H,[de.value?f("",!0):(t(),m(o,{key:0,type:"primary",onClick:ue},{default:r((()=>[b(" 提交 ")])),_:1})),n(o,{onClick:ie},{default:r((()=>[b("返回")])),_:1})])])),default:r((()=>[n(ve,{ref_key:"ruleFormRef",ref:T,model:u(W),rules:B,"label-width":"100px"},{default:r((()=>[n(pe,null,{default:r((()=>[n(y,{span:8},{default:r((()=>[n(_,{label:"工序编码",prop:"processCode"},{default:r((()=>[n(g,{modelValue:u(W).processCode,"onUpdate:modelValue":a[0]||(a[0]=e=>u(W).processCode=e),disabled:de.value,placeholder:"请输入工序编码"},null,8,["modelValue","disabled"])])),_:1})])),_:1}),de.value?f("",!0):(t(),m(y,{key:0,span:7},{default:r((()=>[n(_,{label:"自动生成",prop:"autoGenFlag"},{default:r((()=>[n(L,{modelValue:u(W).autoGenFlag,"onUpdate:modelValue":a[1]||(a[1]=e=>u(W).autoGenFlag=e),"active-color":"#13ce66",onChange:a[2]||(a[2]=e=>(e=>{if(!e)return;W.value.processCode="",I("PROCESS_CODE").then((e=>{V((()=>{W.value.processCode=e}))}))})(u(W).autoGenFlag))},null,8,["modelValue"])])),_:1})])),_:1})),n(y,{span:8},{default:r((()=>[n(_,{label:"工序名称",prop:"processName"},{default:r((()=>[n(g,{modelValue:u(W).processName,"onUpdate:modelValue":a[3]||(a[3]=e=>u(W).processName=e),disabled:de.value,placeholder:"请输入工序名称"},null,8,["modelValue","disabled"])])),_:1})])),_:1})])),_:1}),n(pe,null,{default:r((()=>[n(y,{span:8},{default:r((()=>[n(_,{label:"工序名称",prop:"processName"},{default:r((()=>[n(g,{modelValue:u(W).processName,"onUpdate:modelValue":a[4]||(a[4]=e=>u(W).processName=e),disabled:de.value,placeholder:"请输入工序名称"},null,8,["modelValue","disabled"])])),_:1})])),_:1}),n(y,{span:7},{default:r((()=>[n(_,{label:"是否启用",prop:"enableFlag"},{default:r((()=>[n(me,{modelValue:u(W).enableFlag,"onUpdate:modelValue":a[5]||(a[5]=e=>u(W).enableFlag=e),disabled:de.value},{default:r((()=>[(t(!0),d(p,null,c(u(z),((e,a)=>(t(),m(ce,{label:e.value,key:a},{default:r((()=>[b(v(e.label),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1}),n(y,{span:8},{default:r((()=>[n(_,{label:"准备时间",prop:"preparationTime"},{default:r((()=>[n(be,{modelValue:u(W).preparationTime,"onUpdate:modelValue":a[6]||(a[6]=e=>u(W).preparationTime=e),disabled:de.value,"value-format":"YYYY-MM-DD",type:"date",placeholder:"准备时间"},null,8,["modelValue","disabled"])])),_:1})])),_:1})])),_:1}),n(pe,null,{default:r((()=>[n(y,{span:8},{default:r((()=>[n(_,{label:"生产时间",prop:"productiveTime"},{default:r((()=>[n(be,{disabled:de.value,modelValue:u(W).productiveTime,"onUpdate:modelValue":a[7]||(a[7]=e=>u(W).productiveTime=e),"value-format":"YYYY-MM-DD",type:"date",placeholder:"生产时间"},null,8,["disabled","modelValue"])])),_:1})])),_:1}),n(y,{span:8},{default:r((()=>[n(_,{label:"工序说明",prop:"attention"},{default:r((()=>[n(g,{disabled:de.value,modelValue:u(W).attention,"onUpdate:modelValue":a[8]||(a[8]=e=>u(W).attention=e),placeholder:"请输入内容"},null,8,["disabled","modelValue"])])),_:1})])),_:1}),n(y,{span:8},{default:r((()=>[n(_,{label:"是否质检",prop:"qualityInspection"},{default:r((()=>[n(me,{modelValue:u(W).qualityInspection,"onUpdate:modelValue":a[9]||(a[9]=e=>u(W).qualityInspection=e),disabled:de.value},{default:r((()=>[(t(!0),d(p,null,c(u(z),((e,a)=>(t(),m(ce,{label:e.value,key:a},{default:r((()=>[b(v(e.label),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1})])),_:1}),n(pe),n(pe,null,{default:r((()=>[n(y,{span:8},{default:r((()=>[n(_,{label:"备注",prop:"remark"},{default:r((()=>[n(g,{disabled:de.value,autosize:"",modelValue:u(W).remark,"onUpdate:modelValue":a[10]||(a[10]=e=>u(W).remark=e),type:"textarea",placeholder:"请输入内容"},null,8,["disabled","modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])],64)}}}),[["__file","/Users/alex/Downloads/万界星空/产品研发/MES框架/dev/xiejinrun/new_open_mes_front/src/views/prodMgmt/processSet/index.vue"]]);export{B as default};
