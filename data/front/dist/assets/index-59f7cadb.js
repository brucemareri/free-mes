import{az as e,aZ as a,cC as t,cD as l,h as s,cE as n,bZ as o,a_ as d,cF as r,d as i,aw as u,o as c,c as m,F as p,n as f,t as v,a as y,J as h,j as g,p as k,U as b,aD as x,b9 as w,e as D,cG as _,cH as C,cI as V,cJ as O,cK as S,bc as $,k as z,w as A,Z as P,X as E,cL as L,as as U,aV as j,ao as M,G as R,aE as W,r as I,f as N,g as B,a6 as F,c2 as H,m as q,v as T,aq as Y,E as Q,A as Z,cd as G,B as J,H as K,at as X,au as ee,ab as ae,ac as te,ad as le,aO as se,ae as ne,a0 as oe,x as de,y as re,_ as ie}from"./index-4bfb878d.js";import{c as ue}from"./index-6c8a85ac.js";import{e as ce}from"./index-eba8b5f4.js";import{L as me}from"./install-0b998475.js";const pe=e({selectedDay:{type:a(Object)},range:{type:a(Array)},date:{type:a(Object),required:!0},hideHeader:{type:Boolean}}),fe={pick:e=>t(e)},ve=(e,a)=>{s.extend(n);const t=s.localeData().firstDayOfWeek(),{t:i,lang:u}=o(),c=s().locale(u.value),m=d((()=>!!e.range&&!!e.range.length)),p=d((()=>{let a=[];if(m.value){const[t,s]=e.range,n=l(s.date()-t.date()+1).map((e=>({text:t.date()+e,type:"current"})));let o=n.length%7;o=0===o?0:7-o;const d=l(o).map(((e,a)=>({text:a+1,type:"next"})));a=n.concat(d)}else{const s=e.date.startOf("month").day(),n=((e,a)=>{const t=e.subtract(1,"month").endOf("month").date();return l(a).map(((e,l)=>t-(a-l-1)))})(e.date,(s-t+7)%7).map((e=>({text:e,type:"prev"}))),o=(e=>{const a=e.daysInMonth();return l(a).map(((e,a)=>a+1))})(e.date).map((e=>({text:e,type:"current"})));a=[...n,...o];const d=7-(a.length%7||7),r=l(d).map(((e,a)=>({text:a+1,type:"next"})));a=a.concat(r)}return(e=>l(e.length/7).map((a=>{const t=7*a;return e.slice(t,t+7)})))(a)})),f=d((()=>{const e=t;return 0===e?r.map((e=>i(`el.datepicker.weeks.${e}`))):r.slice(e).concat(r.slice(0,e)).map((e=>i(`el.datepicker.weeks.${e}`)))})),v=(a,t)=>{switch(t){case"prev":return e.date.startOf("month").subtract(1,"month").date(a);case"next":return e.date.startOf("month").add(1,"month").date(a);case"current":return e.date.date(a)}};return{now:c,isInRange:m,rows:p,weekDays:f,getFormattedDate:v,handlePickDay:({text:e,type:t})=>{const l=v(e,t);a("pick",l)},getSlotData:({text:a,type:t})=>{const l=v(a,t);return{isSelected:l.isSame(e.selectedDay),type:`${t}-month`,day:l.format("YYYY-MM-DD"),date:l.toDate()}}}},ye={key:0},he=["onClick"],ge=i({name:"DateTable"});var ke=x(i({...ge,props:pe,emits:fe,setup(e,{expose:a,emit:t}){const l=e,{isInRange:s,now:n,rows:o,weekDays:d,getFormattedDate:r,handlePickDay:i,getSlotData:x}=ve(l,t),w=u("calendar-table"),D=u("calendar-day"),_=({text:e,type:a})=>{const t=[a];if("current"===a){const s=r(e,a);s.isSame(l.selectedDay,"day")&&t.push(D.is("selected")),s.isSame(n,"day")&&t.push(D.is("today"))}return t};return a({getFormattedDate:r}),(e,a)=>(c(),m("table",{class:k([y(w).b(),y(w).is("range",y(s))]),cellspacing:"0",cellpadding:"0"},[e.hideHeader?h("v-if",!0):(c(),m("thead",ye,[(c(!0),m(p,null,f(y(d),(e=>(c(),m("th",{key:e},v(e),1)))),128))])),g("tbody",null,[(c(!0),m(p,null,f(y(o),((a,t)=>(c(),m("tr",{key:t,class:k({[y(w).e("row")]:!0,[y(w).em("row","hide-border")]:0===t&&e.hideHeader})},[(c(!0),m(p,null,f(a,((a,t)=>(c(),m("td",{key:t,class:k(_(a)),onClick:e=>y(i)(a)},[g("div",{class:k(y(D).b())},[b(e.$slots,"date-cell",{data:y(x)(a)},(()=>[g("span",null,v(a.text),1)]))],2)],10,he)))),128))],2)))),128))])],2))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/calendar/src/date-table.vue"]]);const be=e({modelValue:{type:Date},range:{type:a(Array),validator:e=>$(e)&&2===e.length&&e.every((e=>S(e)))}}),xe={[C]:e=>S(e),[_]:e=>S(e)},we="ElCalendar",De=i({name:we});const _e=W(x(i({...De,props:be,emits:xe,setup(e,{expose:a,emit:t}){const l=e,n=u("calendar"),{calculateValidatedDateRange:r,date:i,pickDay:x,realSelectedDay:S,selectDate:$,validatedRange:W}=((e,a,t)=>{const l=w(),{lang:n}=o(),r=D(),i=s().locale(n.value),u=d({get:()=>e.modelValue?m.value:r.value,set(e){if(!e)return;r.value=e;const t=e.toDate();a(_,t),a(C,t)}}),c=d((()=>{if(!e.range)return[];const a=e.range.map((e=>s(e).locale(n.value))),[l,o]=a;return l.isAfter(o)?(V(t,"end time should be greater than start time"),[]):l.isSame(o,"month")?h(l,o):l.add(1,"month").month()!==o.month()?(V(t,"start time and end time interval must not exceed two months"),[]):h(l,o)})),m=d((()=>e.modelValue?s(e.modelValue).locale(n.value):u.value||(c.value.length?c.value[0][0]:i))),p=d((()=>m.value.subtract(1,"month").date(1))),f=d((()=>m.value.add(1,"month").date(1))),v=d((()=>m.value.subtract(1,"year").date(1))),y=d((()=>m.value.add(1,"year").date(1))),h=(e,a)=>{const l=e.startOf("week"),s=a.endOf("week"),n=l.get("month"),o=s.get("month");return n===o?[[l,s]]:(n+1)%12===o?((e,a)=>{const t=e.endOf("month"),l=a.startOf("month"),s=t.isSame(l,"week");return[[e,t],[(s?l.add(1,"week"):l).startOf("week"),a]]})(l,s):n+2===o||(n+1)%11===o?((e,a)=>{const t=e.endOf("month"),l=e.add(1,"month").startOf("month"),s=t.isSame(l,"week")?l.add(1,"week"):l,n=s.endOf("month"),o=a.startOf("month"),d=n.isSame(o,"week")?o.add(1,"week"):o;return[[e,t],[s.startOf("week"),n],[d.startOf("week"),a]]})(l,s):(V(t,"start time and end time interval must not exceed two months"),[])},g=e=>{u.value=e};return O({from:'"dateCell"',replacement:'"date-cell"',scope:"ElCalendar",version:"2.3.0",ref:"https://element-plus.org/en-US/component/calendar.html#slots",type:"Slot"},d((()=>!!l.dateCell))),{calculateValidatedDateRange:h,date:m,realSelectedDay:u,pickDay:g,selectDate:e=>{const a={"prev-month":p.value,"next-month":f.value,"prev-year":v.value,"next-year":y.value,today:i}[e];a.isSame(m.value,"day")||g(a)},validatedRange:c}})(l,t,we),{t:I}=o(),N=d((()=>{const e=`el.datepicker.month${i.value.format("M")}`;return`${i.value.year()} ${I("el.datepicker.year")} ${I(e)}`}));return a({selectedDay:S,pickDay:x,selectDate:$,calculateValidatedDateRange:r}),(e,a)=>(c(),m("div",{class:k(y(n).b())},[g("div",{class:k(y(n).e("header"))},[b(e.$slots,"header",{date:y(N)},(()=>[g("div",{class:k(y(n).e("title"))},v(y(N)),3),0===y(W).length?(c(),m("div",{key:0,class:k(y(n).e("button-group"))},[z(y(L),null,{default:A((()=>[z(y(P),{size:"small",onClick:a[0]||(a[0]=e=>y($)("prev-month"))},{default:A((()=>[E(v(y(I)("el.datepicker.prevMonth")),1)])),_:1}),z(y(P),{size:"small",onClick:a[1]||(a[1]=e=>y($)("today"))},{default:A((()=>[E(v(y(I)("el.datepicker.today")),1)])),_:1}),z(y(P),{size:"small",onClick:a[2]||(a[2]=e=>y($)("next-month"))},{default:A((()=>[E(v(y(I)("el.datepicker.nextMonth")),1)])),_:1})])),_:1})],2)):h("v-if",!0)]))],2),0===y(W).length?(c(),m("div",{key:0,class:k(y(n).e("body"))},[z(ke,{date:y(i),"selected-day":y(S),onPick:y(x)},U({_:2},[e.$slots["date-cell"]||e.$slots.dateCell?{name:"date-cell",fn:A((a=>[e.$slots["date-cell"]?b(e.$slots,"date-cell",j(M({key:0},a))):b(e.$slots,"dateCell",j(M({key:1},a)))]))}:void 0]),1032,["date","selected-day","onPick"])],2)):(c(),m("div",{key:1,class:k(y(n).e("body"))},[(c(!0),m(p,null,f(y(W),((a,t)=>(c(),R(ke,{key:t,date:a[0],"selected-day":y(S),range:a,"hide-header":0!==t,onPick:y(x)},U({_:2},[e.$slots["date-cell"]||e.$slots.dateCell?{name:"date-cell",fn:A((a=>[e.$slots["date-cell"]?b(e.$slots,"date-cell",j(M({key:0},a))):b(e.$slots,"dateCell",j(M({key:1},a)))]))}:void 0]),1032,["date","selected-day","range","hide-header","onPick"])))),128))],2))],2))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/calendar/src/calendar.vue"]])),Ce=[{prop:"peopleId",label:"人员编号",width:"100"},{prop:"planPeopleName",label:"人员名称"},{prop:"startDate",label:"开始时间",width:"180"},{prop:"endDate",label:"结束时间",width:"180"},{prop:"taskCode",label:"任务编号"},{prop:"peopleQuantity",label:"任务数量"}],Ve=e=>(de("data-v-c226dc9f"),e=e(),re(),e),Oe=["onContextmenu"],Se={class:"lunar",style:{"font-size":"17px"}},$e=Ve((()=>g("div",{id:"barsSchedulingECharts",style:{height:"520px",width:"100vh"}},null,-1))),ze=Ve((()=>g("div",{id:"barsReportWorkECharts",style:{height:"520px",width:"100vh"}},null,-1))),Ae=ie(i({__name:"index",props:{},setup(e){let a=ce;const t=D("first"),l=N({total:0,pageSize:10,pageSizes:[5,10,15,20],currentPage:1}),s=D([{key:"today",highlight:!0,dates:new Date,popover:{label:"美好的一天！要开心呦！"}}]),n=D({start:new Date,end:new Date}),o=D(new Date),d=D(!1),r=D({teamName:"",timeOfDayActive:"白班",isWorkingDay:!0}),i=D([]),u=D(),k=D([]),b=D(),x=D({tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},title:{left:"center",text:""},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:[],axisTick:{alignWithLabel:!0}},yAxis:{type:"value"},series:[{label:{show:!0,fontSize:37,position:"inside"},data:[],type:"bar",showBackground:!0,backgroundStyle:{color:new me(0,0,0,1,[{offset:0,color:"#83bff6"},{offset:.5,color:"#188df0"},{offset:1,color:"#188df0"}])},emphasis:{itemStyle:{color:new me(0,0,0,1,[{offset:0,color:"#2378f7"},{offset:.7,color:"#2378f7"},{offset:1,color:"#83bff6"}])}}}]}),w=D({tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},title:{left:"center",text:""},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:[],axisTick:{alignWithLabel:!0}},yAxis:{type:"value"},series:[{label:{show:!0,fontSize:37,position:"inside"},data:[],type:"bar",showBackground:!0,backgroundStyle:{color:new me(0,0,0,1,[{offset:0,color:"#83bff6"},{offset:.5,color:"#188df0"},{offset:1,color:"#188df0"}])},emphasis:{itemStyle:{color:new me(0,0,0,1,[{offset:0,color:"#2378f7"},{offset:.7,color:"#2378f7"},{offset:1,color:"#83bff6"}])}}}]}),_=D(0),C=D(1),V=D(0),O=D(1),S=D(),$=()=>{de()},P=e=>{C.value=e,ie()},L=e=>{O.value=e,pe()},U=e=>{},j=e=>{},M=()=>{de()},W=async e=>{await(async e=>await I.get({url:"/admin-api/mes/cla/calendar/findPlanTeam",params:e}))({time:e.day}).then((e=>{var a;const{list:t}=e||{};i.value=t,r.value.teamName=null==(a=t[0])?void 0:a.teamCode})),de(),d.value=!0},de=()=>{const e={teamCode:r.value.teamName,shiftWay:r.value.timeOfDayActive};u.value=!0,(async e=>await I.get({url:"/admin-api/mes/cla/calendar/findPlanMember",params:e}))(e).then((e=>{k.value=e})).finally((()=>{u.value=!1}))},re=()=>{r.value={timeOfDayActive:"白班"},d.value=!1},ie=()=>{let e=q(a.init(document.getElementById("barsSchedulingECharts")));(async e=>await I.get({url:"/admin-api/mes/cla/calendar/scheduleQuantityList",params:e}))({page:C.value}).then((a=>{x.value.title.text="排产柱状图",_.value=a.total,x.value.xAxis.data=a.time,x.value.series[0].data=a.quantity,e.setOption(x.value,!0)}))},pe=()=>{let e=q(a.init(document.getElementById("barsReportWorkECharts")));(async e=>await I.get({url:"/admin-api/mes/cla/calendar/feedbackQuantityList",params:e}))({page:O.value}).then((a=>{w.value.title.text="报工柱状图",V.value=a.total,w.value.xAxis.data=a.time,w.value.series[0].data=a.quantity,e.setOption(w.value,!0)}))},fe=()=>{(async()=>await I.get({url:"/admin-api/mes/cla/calendar/calendarList"}))().then((e=>{S.value=e.result}))};return B((()=>{(()=>{if(null!=b.value&&""!=b.value&&null!=b.value)return b.value.dispose();ie(),pe(),window.onresize=function(){b.value.resize()}})(),fe()})),(e,a)=>{const b=F("VDatePicker"),x=T,w=Y,D=Q,C=_e,O=Z,I=G,N=J,B=K,q=X,de=ee,ie=ae,ce=te,me=le,pe=se,fe=ne,ve=oe;return c(),m(p,null,[z(B,null,{default:A((()=>[z(D,{gutter:50},{default:A((()=>[z(x,{span:7,xs:25},{default:A((()=>[z(b,{attributes:s.value,expanded:"",rows:2,step:1,onDayclick:U,modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=e=>n.value=e),modelModifiers:{range:!0}},null,8,["attributes","modelValue"])])),_:1}),z(x,{span:16,xs:25},{default:A((()=>[z(N,{modelValue:t.value,"onUpdate:modelValue":a[2]||(a[2]=e=>t.value=e),class:"demo-tabs"},{default:A((()=>[z(O,{label:"排产",name:"first"},{default:A((()=>[z(C,{modelValue:o.value,"onUpdate:modelValue":a[1]||(a[1]=e=>o.value=e)},{"date-cell":A((({data:e})=>[g("div",{style:{height:"100%"},onContextmenu:H((a=>W(e)),["prevent"])},[z(D,null,{default:A((()=>[z(x,{span:15},{default:A((()=>[g("div",Se,v(e.day.split("-").slice(1).join("-")),1)])),_:2},1024),z(x,{span:8},{default:A((()=>[z(w,{effect:"dark",type:"success"},{default:A((()=>[E("班")])),_:1})])),_:1})])),_:2},1024),(c(!0),m(p,null,f(S.value,((a,t)=>(c(),m("div",{key:t},[a.date==e.day?(c(),R(D,{key:0},{default:A((()=>[z(x,{style:{"font-size":"14px",color:"#409eff"},span:24},{default:A((()=>[E("班组数量："+v(a.teamCount),1)])),_:2},1024)])),_:2},1024)):h("",!0)])))),128))],40,Oe)])),_:1},8,["modelValue"])])),_:1}),z(O,{label:"报工",name:"2"},{default:A((()=>[$e,z(I,{background:"",onCurrentChange:P,"default-page-size":7,layout:"prev, pager, next",total:_.value},null,8,["total"]),ze,z(I,{background:"",onCurrentChange:L,"default-page-size":7,layout:"prev, pager, next",total:V.value},null,8,["total"])])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),z(ve,{modelValue:d.value,"onUpdate:modelValue":a[6]||(a[6]=e=>d.value=e),title:"设置日期",width:"70%",onClose:re},{footer:A((()=>[])),default:A((()=>[z(fe,{model:r.value,inline:!0},{default:A((()=>[z(D,null,{default:A((()=>[z(x,{span:8},{default:A((()=>[z(ie,{label:"班组名称"},{default:A((()=>[z(de,{modelValue:r.value.teamName,"onUpdate:modelValue":a[3]||(a[3]=e=>r.value.teamName=e),placeholder:"请选择班组名称",clearable:"",onChange:$},{default:A((()=>[(c(!0),m(p,null,f(i.value,(e=>(c(),R(q,{key:e.teamCode,label:e.teamName,value:e.teamCode},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),z(x,{span:11},{default:A((()=>[z(ie,null,{default:A((()=>[z(me,{modelValue:r.value.timeOfDayActive,"onUpdate:modelValue":a[4]||(a[4]=e=>r.value.timeOfDayActive=e),onChange:M},{default:A((()=>[z(ce,{label:"白班",size:"large"},{default:A((()=>[E("白班")])),_:1}),z(ce,{label:"中班",size:"large"},{default:A((()=>[E("中班")])),_:1}),z(ce,{label:"晚班",size:"large"},{default:A((()=>[E("晚班")])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1}),z(x,{span:3},{default:A((()=>[z(ie,{label:"工作类型"},{default:A((()=>[z(pe,{style:{"--el-switch-on-color":"#409eff","--el-switch-off-color":"#67c23a"},modelValue:r.value.isWorkingDay,"onUpdate:modelValue":a[5]||(a[5]=e=>r.value.isWorkingDay=e),"active-text":"班","inactive-text":"休",onChange:j},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model"]),z(ue,{pagination:y(l),tableData:k.value,columns:y(Ce),loading:u.value},null,8,["pagination","tableData","columns","loading"])])),_:1},8,["modelValue"])],64)}}}),[["__scopeId","data-v-c226dc9f"],["__file","/Users/alex/Downloads/万界星空/产品研发/MES框架/dev/xiejinrun/new_open_mes_front/src/views/scheduling/schedulingCalendar/index.vue"]]);export{Ae as default};
