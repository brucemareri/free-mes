import{q as e,f as t,D as a,d as s,u as i,K as l,C as n,o as r,G as o,w as c,k as m,a as u,I as d,c as p,F as f,n as _,j as S,t as y,J as b,aK as h,L as T,ap as C,Z as k,M as w,N as x,H as E,_ as P}from"./index-4bfb878d.js";import{b as I,a as D}from"./index-ca7d0818.js";import{u as M}from"./useVxeCrudSchemas-092b8963.js";import{u as g}from"./useXTable-309dffed.js";const{t:v}=e(),B=t({primaryKey:"id",primaryType:null,primaryTitle:"编号",action:!0,actionWidth:"200px",columns:[{title:"编号",field:"id",table:{width:320}},{title:"流程名",field:"name",isSearch:!0},{title:"所属流程",field:"processDefinitionId",isSearch:!0,isTable:!1},{title:"流程分类",field:"category",dictType:a.BPM_MODEL_CATEGORY,dictClass:"number",isSearch:!0,table:{slots:{default:"category_default"}}},{title:"当前审批任务",field:"tasks",table:{width:140,slots:{default:"tasks_default"}}},{title:v("common.status"),field:"status",dictType:a.BPM_PROCESS_INSTANCE_STATUS,dictClass:"number",isSearch:!0},{title:"结果",field:"result",dictType:a.BPM_PROCESS_INSTANCE_RESULT,dictClass:"number",isSearch:!0},{title:"提交时间",field:"createTime",formatter:"formatDate",table:{width:180},isForm:!1,isSearch:!0,search:{show:!0,itemRender:{name:"XDataTimePicker"}}},{title:"结束时间",field:"endTime",formatter:"formatDate",table:{width:180},isForm:!1}]}),{allSchemas:R}=M(B),j=P(s({__name:"index",setup(t){const s=i(),P=l(),{t:M}=e(),[v,{reload:B}]=g({allSchemas:R,getListApi:I}),j=()=>{s.push({name:"BpmProcessInstanceCreate"})};return(e,t)=>{const i=T,l=C,I=k,g=w,R=x,A=E,N=n("hasPermi");return r(),o(A,null,{default:c((()=>[m(R,{onRegister:u(v)},{toolbar_buttons:c((()=>[d(m(i,{type:"primary",preIcon:"ep:zoom-in",title:"发起流程",onClick:j},null,512),[[N,["bpm:process-instance:query"]]])])),category_default:c((({row:e})=>[m(l,{type:u(a).BPM_MODEL_CATEGORY,value:Number(null==e?void 0:e.category)},null,8,["type","value"])])),tasks_default:c((({row:e})=>[(r(!0),p(f,null,_(e.tasks,(e=>(r(),o(I,{key:e.id,link:""},{default:c((()=>[S("span",null,y(e.name),1)])),_:2},1024)))),128))])),actionbtns_default:c((({row:e})=>[d(m(g,{preIcon:"ep:view",title:u(M)("action.detail"),onClick:t=>(e=>{s.push({name:"BpmProcessInstanceDetail",query:{id:e.id}})})(e)},null,8,["title","onClick"]),[[N,["bpm:process-instance:cancel"]]]),1===e.result?d((r(),o(g,{key:0,preIcon:"ep:delete",title:"取消",onClick:t=>(e=>{h.prompt("请输入取消原因","取消流程",{confirmButtonText:M("common.ok"),cancelButtonText:M("common.cancel"),inputPattern:/^[\s\S]*.*\S[\s\S]*$/,inputErrorMessage:"取消原因不能为空"}).then((async({value:t})=>{await D(e.id,t),P.success("取消成功"),B()}))})(e)},null,8,["onClick"])),[[N,["bpm:process-instance:query"]]]):b("",!0)])),_:1},8,["onRegister"])])),_:1})}}}),[["__file","/Users/alex/Downloads/万界星空/产品研发/MES框架/dev/xiejinrun/new_open_mes_front/src/views/bpm/processInstance/index.vue"]]);export{j as default};
