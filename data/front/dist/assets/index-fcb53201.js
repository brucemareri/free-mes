import{f as e,D as a,r as l,d as t,q as i,e as s,g as d,C as o,o as n,c as u,k as r,w as m,a as c,G as p,F as f,n as T,j as y,t as v,X as h,J as g,I as S,z as b,at as _,au as I,ap as w,M,N as k,H as C,a1 as x,L as E,a0 as V,_ as j}from"./index-4bfb878d.js";import{u as U}from"./useVxeCrudSchemas-092b8963.js";import{b as A}from"./index-083d1298.js";import{u as D}from"./useXTable-309dffed.js";const L=e({primaryKey:"id",primaryTitle:"编号",primaryType:"id",action:!0,actionWidth:"70",columns:[{title:"发送时间",field:"sendTime",table:{width:180},formatter:"formatDate",search:{show:!0,itemRender:{name:"XDataTimePicker"}}},{title:"接收邮箱",field:"toMail",isSearch:!0,table:{width:180,slots:{default:"toMail_default"}}},{title:"用户编号",field:"userId",isSearch:!0,isTable:!1},{title:"用户类型",field:"userType",dictType:a.USER_TYPE,dictClass:"number",isSearch:!0,isTable:!1},{title:"邮件标题",field:"templateTitle"},{title:"邮件内容",field:"templateContent",isTable:!1},{title:"邮箱参数",field:"templateParams",isTable:!1},{title:"发送状态",field:"sendStatus",dictType:a.SYSTEM_MAIL_SEND_STATUS,dictClass:"string",isSearch:!0},{title:"邮箱账号",field:"accountId",isSearch:!0,isTable:!1,search:{slots:{default:"accountId_search"}}},{title:"发送邮箱地址",field:"fromMail",table:{title:"邮箱账号"}},{title:"模板编号",field:"templateId",isSearch:!0},{title:"模板编码",field:"templateCode",isTable:!1},{title:"模版发送人名称",field:"templateNickname",isTable:!1},{title:"发送返回的消息编号",field:"sendMessageId",isTable:!1},{title:"发送异常",field:"sendException",isTable:!1},{title:"创建时间",field:"createTime",isTable:!1}]}),{allSchemas:P}=U(L),R=async e=>await l.get({url:"/admin-api/system/mail-log/page",params:e}),N={key:0},X=t({name:"MailLog"}),Y=j(t({...X,setup(t){const{t:j}=i(),U=e({accountId:null}),[L]=D({allSchemas:P,topActionSlots:!1,params:U,getListApi:R}),X=s([]),Y=s(!1),q=s("edit"),z=s(!1),F=s(""),G=s(!1),H=s(),J=async e=>{var a;a="detail",z.value=!0,q.value=j("action."+a),F.value=a,Y.value=!0;const t=await(async e=>await l.get({url:"/admin-api/system/mail-log/get?id="+e}))(e);H.value=t,z.value=!1};return d((()=>{A().then((e=>{X.value=e}))})),(e,l)=>{const t=_,i=I,s=w,d=M,A=k,D=C,R=x,K=E,Q=V,W=o("hasPermi");return n(),u(f,null,[r(D,null,{default:m((()=>[r(A,{onRegister:c(L)},{accountId_search:m((()=>[r(i,{modelValue:c(U).accountId,"onUpdate:modelValue":l[0]||(l[0]=e=>c(U).accountId=e)},{default:m((()=>[(n(),p(t,{key:void 0,label:"全部",value:void 0})),(n(!0),u(f,null,T(c(X),(e=>(n(),p(t,{key:e.id,label:e.mail,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),toMail_default:m((({row:e})=>[y("div",null,v(e.toMail),1),e.userType&&e.userId?(n(),u("div",N,[r(s,{type:c(a).USER_TYPE,value:e.userType},null,8,["type","value"]),h(v("("+e.userId+")"),1)])):g("",!0)])),actionbtns_default:m((({row:e})=>[S(r(d,{preIcon:"ep:view",title:c(j)("action.detail"),onClick:a=>J(e.id)},null,8,["title","onClick"]),[[W,["system:mail-log:query"]]])])),_:1},8,["onRegister"])])),_:1}),r(Q,{id:"mailLogModel",loading:c(z),modelValue:c(Y),"onUpdate:modelValue":l[2]||(l[2]=e=>b(Y)?Y.value=e:null),title:c(q)},{footer:m((()=>[r(K,{loading:c(G),title:c(j)("dialog.close"),onClick:l[1]||(l[1]=e=>Y.value=!1)},null,8,["loading","title"])])),default:m((()=>["detail"===c(F)?(n(),p(R,{key:0,schema:c(P).detailSchema,data:c(H)},null,8,["schema","data"])):g("",!0)])),_:1},8,["loading","modelValue","title"])],64)}}}),[["__file","/Users/alex/Downloads/万界星空/产品研发/MES框架/dev/xiejinrun/new_open_mes_front/src/views/system/mail/log/index.vue"]]);export{Y as default};
