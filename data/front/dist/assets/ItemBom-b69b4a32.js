import{f as e,d as a,a_ as l,e as t,g as o,o as i,c as s,G as n,w as d,k as r,X as m,a as u,J as p,as as b,j as c,F as f,aK as g,aR as y,Z as _,v,E as I,aa as k,ab as V,aL as h,ae as S,a0 as w,_ as O}from"./index-4bfb878d.js";import{c as C}from"./index-6c8a85ac.js";import M from"./index-6ebcd94a.js";import{q as x,d as N,u as P,s as F,a as j}from"./index-f736ac6b.js";const B=e([{type:"primary",icon:"plus",state:"add",label:"新增",disabled:!1,permissions:[]},{type:"success",icon:"edit",state:"edit",label:"修改",disabled:!0,permissions:[]},{type:"danger",icon:"delete",state:"remove",label:"批量删除",disabled:!0,permissions:[]},{type:"info",icon:"upload2",state:"import",label:"导入",disabled:!1,permissions:[]},{type:"warning",icon:"ep:zoom-in",state:"export",label:"导出",disabled:!1,permissions:[]}]),U=[{label:"物料编码",slot:"itemCode",width:"150"},{prop:"itemName",label:"物料名称",width:"100"},{prop:"specification",label:"规格型号"},{prop:"unitOfMeasure",label:"单位"},{prop:"itemOrProduct",label:"物料/产品",slot:"itemOrProduct",width:"100"},{prop:"itemTypeName",label:"所属分类",width:"100"},{prop:"enableFlag",label:"是否启用",slot:"enableFlag"},{prop:"safeStockFlag",label:"安全库存",slot:"safeStockFlag",width:"120"},{prop:"createTime",label:"创建时间",width:"180"},{label:"操作",slot:"operation",width:"120",fixed:"right"}],q=[{prop:"bomItemCode",label:"物料编码",width:"120"},{prop:"bomItemName",label:"物料名称"},{prop:"bomItemSpec",label:"规格"},{prop:"unitOfMeasure",label:"单位"},{prop:"quantity",label:"使用比例"},{prop:"remark",label:"备注"},{label:"操作",slot:"operation",width:"120",fixed:"right"}],z=[{label:"是",key:"Y"},{label:"否",key:"N"}],D={class:"dialog-footer"},R=O(a({__name:"ItemBom",props:{dialogState:{type:String,default:()=>""},bomParams:{type:Number}},setup(a){const O=a,B=l((()=>!A.value.length)),U=t(null),z=t();let R=t([]);const T=e({total:0,pageSize:10,pageSizes:[5,10,15,20],currentPage:1});let A=t([]);const E=t(!1),G=t(!1);let H=t({bomItemCode:"",bomItemName:"",bomItemSpec:"",unitOfMeasure:"",quantity:1,remark:""});const J=e=>{A.value=e.map((e=>e.id))},K=e=>{x(e).then((e=>{H.value=e,G.value=!G.value}))},L=()=>{U.value.visibleProduct=!0},X=e=>{const a=(null==e?void 0:e.id)||A.value;g.confirm("确定删除当前行数据?").then((()=>{Y(a)}))},Y=e=>{const a=Array.isArray(e)?e:[e];N(a).then((e=>{e&&(y.success("删除成功"),$())}))},Z=()=>{z.value&&(z.value.resetFields(),G.value=!G.value)},Q=()=>{P(H.value).then((e=>{y.success("修改成功"),G.value=!G.value,$()}))},W=e=>{if(null==e)return;console.log(e);const a={itemId:O.bomParams,bomItemId:e.id,bomItemCode:e.itemCode,bomItemName:e.itemName,bomItemSpec:e.specification,unitOfMeasure:e.unitOfMeasure,itemOrProduct:e.itemOrProduct,quantity:1,enableFlag:e.enableFlag};F(a).then((e=>{e&&$()}))},$=()=>{const e={pageNo:T.currentPage,pageSize:T.pageSize,itemId:O.bomParams};E.value=!0,j(e).then((e=>{const{list:a,total:l}=e||{};T.total=l,R.value=a})).finally((()=>{E.value=!1}))};return o((()=>{$()})),(e,l)=>{const t=_,o=v,g=I,y=k,O=V,x=h,N=S,P=w;return i(),s(f,null,["View"!==a.dialogState?(i(),n(g,{key:0,gutter:10},{default:d((()=>[r(o,{span:1.5},{default:d((()=>[r(t,{type:"primary",plain:"",icon:"plus",onClick:L},{default:d((()=>[m("新增")])),_:1})])),_:1},8,["span"]),r(o,{span:1.5},{default:d((()=>[r(t,{type:"danger",plain:"",icon:"delete",disabled:u(B),onClick:X},{default:d((()=>[m("删除")])),_:1},8,["disabled"])])),_:1},8,["span"])])),_:1})):p("",!0),r(C,{style:{"margin-top":"16px"},pagination:T,tableData:u(R),columns:u(q),"is-selection":!0,loading:E.value,onSelectionChange:J},b({_:2},["View"!==a.dialogState?{name:"operation",fn:d((({scope:e})=>[r(t,{link:"",type:"primary",onClick:a=>{return l=e.row,void K(null==l?void 0:l.id);var l}},{default:d((()=>[m("修改")])),_:2},1032,["onClick"]),r(t,{link:"",type:"danger",onClick:a=>X(e.row)},{default:d((()=>[m("删除")])),_:2},1032,["onClick"])])),key:"0"}:void 0]),1032,["pagination","tableData","columns","loading"]),r(M,{ref_key:"itemSelectRef",ref:U,onHandleCurrentSubmit:W},null,512),r(P,{title:"修改产品BOM关系",modelValue:G.value,"onUpdate:modelValue":l[6]||(l[6]=e=>G.value=e),width:"34%"},{footer:d((()=>[c("span",D,[r(t,{type:"primary",onClick:Q},{default:d((()=>[m("确定")])),_:1}),r(t,{onClick:Z},{default:d((()=>[m("返回")])),_:1})])])),default:d((()=>[r(N,{model:u(H),prop:"bomItemCode",ref_key:"ruleFormRef",ref:z},{default:d((()=>[r(O,{label:"BOM物料编码"},{default:d((()=>[r(y,{modelValue:u(H).bomItemCode,"onUpdate:modelValue":l[0]||(l[0]=e=>u(H).bomItemCode=e),disabled:""},null,8,["modelValue"])])),_:1}),r(O,{label:"BOM物料名称",prop:"bomItemName"},{default:d((()=>[r(y,{modelValue:u(H).bomItemName,"onUpdate:modelValue":l[1]||(l[1]=e=>u(H).bomItemName=e),disabled:""},null,8,["modelValue"])])),_:1}),r(O,{label:"BOM物料规格",prop:"bomItemSpec"},{default:d((()=>[r(y,{modelValue:u(H).bomItemSpec,"onUpdate:modelValue":l[2]||(l[2]=e=>u(H).bomItemSpec=e),disabled:""},null,8,["modelValue"])])),_:1}),r(O,{label:"BOM物料单位",prop:"unitOfMeasure"},{default:d((()=>[r(y,{modelValue:u(H).unitOfMeasure,"onUpdate:modelValue":l[3]||(l[3]=e=>u(H).unitOfMeasure=e),disabled:""},null,8,["modelValue"])])),_:1}),r(O,{label:"物料使用比例",prop:"quantity"},{default:d((()=>[r(x,{precision:4,step:.1,min:0,modelValue:u(H).quantity,"onUpdate:modelValue":l[4]||(l[4]=e=>u(H).quantity=e),placeholder:"请输入物料使用比例"},null,8,["step","modelValue"])])),_:1}),r(O,{label:"备注",prop:"remark"},{default:d((()=>[r(y,{modelValue:u(H).remark,"onUpdate:modelValue":l[5]||(l[5]=e=>u(H).remark=e),type:"textarea",placeholder:"请输入内容"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])],64)}}}),[["__file","/Users/alex/Downloads/万界星空/产品研发/MES框架/dev/xiejinrun/new_open_mes_front/src/views/masterData/materialManage/components/ItemBom.vue"]]),T=Object.freeze(Object.defineProperty({__proto__:null,default:R},Symbol.toStringTag,{value:"Module"}));export{B,T as I,z as R,U as c,R as i};
