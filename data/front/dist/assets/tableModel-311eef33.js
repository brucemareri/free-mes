import{f as e,r as a,d as l,e as t,o as r,c as d,k as i,w as s,X as u,I as o,G as p,t as n,a as m,J as y,F as b,aH as c,aK as v,aR as f,Z as _,v as g,E as T,b7 as h,aq as w,b8 as k,cg as N,ab as V,aa as I,aL as x,ac as C,ad as F,ae as O,a0 as P,aI as z,_ as L}from"./index-4bfb878d.js";import{P as U}from"./const-f443e30b.js";import{h as j}from"./tree-5260b4e2.js";const M="Y",q={[M]:"是",N:"否"},E=e([{type:"input",label:"分类名称",prop:"itemTypeName",placeholder:"请输入分类名称"},{type:"select",label:"是否启用",prop:"enableFlag",placeholder:"选择是或否",options:[{value:M,label:"是"},{value:"N",label:"否"}]},{type:"select",label:"物料产品",prop:"itemOrProduct",placeholder:"选择物料产品",options:[{value:"ITEM",label:"物料"},{value:"PRODUCT",label:"产品"}]}]),S=async e=>await a.get({url:"/admin-api/mes/md/itemType/list",params:e}),D=L(l({__name:"tableModel",props:{tableFormList:{type:Array,default:()=>Array},tableLoading:{type:Boolean,default:!1}},emits:["updateTableList"],setup(l,{emit:L}){const E=t(),D=e({parentTypeId:[{required:!0,message:"父分类不能为空",trigger:"blur"}],itemTypeName:[{required:!0,message:"分类名称不能为空",trigger:"blur"}],orderNum:[{required:!0,message:"显示排序不能为空",trigger:"blur"}],itemOrProduct:[{required:!0,message:"请选择是产品分类还是物料分类",trigger:["blur"]}]}),R=t({value:"id",label:"itemTypeName",children:"children",checkStrictly:!0});let Y=e([]),$=t({parentTypeId:0,id:"",itemTypeName:"",orderNum:0,itemOrProduct:"物料",enableFlag:M});const A=t(""),B=t(!1),G=t(!0),H=t(!0),J=()=>{H.value=!H.value,G.value=!G.value,c((()=>{H.value=!H.value}))},K=()=>{$.value.parentTypeId=0,$.value.id="",$.value.itemTypeName="",$.value.orderNum=0,$.value.itemOrProduct="ITEM",$.value.enableFlag="Y"},X=e=>{(async e=>await a.get({url:`/admin-api/mes/md/itemType/get/${e}`}))(null==e?void 0:e.id).then((e=>{$.value=e,B.value=!B.value}))},Z=e=>{v.confirm(`是否确认删除【${null==e?void 0:e.itemTypeName}】分类？`).then((()=>(async e=>await a.delete({url:`/admin-api/mes/md/itemType/${e}`}))(e.id).then((e=>{e&&(f.success("删除成功"),L("updateTableList"))}))))},Q=async e=>{e&&await e.validate((e=>{e&&($.value.id?(async e=>await a.put({url:"/admin-api/mes/md/itemType/update",data:e}))($.value).then((e=>{e&&(B.value=!B.value,L("updateTableList"))})):(async e=>await a.post({url:"/admin-api/mes/md/itemType/save",data:e}))($.value).then((e=>{e&&(f({message:"新增成功",type:"success"}),B.value=!B.value,L("updateTableList"))})))}))},W=()=>{K(),B.value=!B.value};return(e,a)=>{const t=_,c=g,v=T,f=h,L=w,ee=k,ae=N,le=V,te=I,re=x,de=C,ie=F,se=O,ue=P,oe=z;return r(),d(b,null,[i(v,{gutter:10,class:"mb8"},{default:s((()=>[i(c,{span:1.5,style:{"margin-bottom":"16px"}},{default:s((()=>[i(t,{icon:"Switch",type:"info",plain:"",onClick:J,disabled:!l.tableFormList.length},{default:s((()=>[u("展开/折叠")])),_:1},8,["disabled"])])),_:1},8,["span"])])),_:1}),H.value?o((r(),p(ee,{key:0,data:l.tableFormList,"row-key":"id","default-expand-all":G.value,"tree-props":{children:"children",hasChildren:"hasChildren"}},{default:s((()=>[i(f,{prop:"itemTypeName",label:"分类名称"}),i(f,{prop:"orderNum",label:"排序"}),i(f,{prop:"itemOrProduct",label:"物料/产品"},{default:s((e=>[u(n(m(U)[e.row.itemOrProduct])+" ",1)])),_:1}),i(f,{prop:"enableFlag",label:"是否启用"},{default:s((e=>[i(L,{type:e.row.enableFlag===m(M)?"success":"warning"},{default:s((()=>[u(n(m(q)[e.row.enableFlag]),1)])),_:2},1032,["type"])])),_:1}),i(f,{prop:"createTime",label:"创建时间",width:"160"}),i(f,{label:"操作",width:"210"},{default:s((e=>[i(t,{style:{"font-size":"17px"},type:"primary",link:"",key:"plain",size:"small",onClick:a=>{return l=e.row,K(),void(l&&($.value.parentTypeId=l.id,S().then((e=>{const{list:a=[]}=e||{},l=j(a,"id","parentTypeId");Y=l,B.value=!B.value,A.value="添加产品分类"}))));var l}},{default:s((()=>[u("新增")])),_:2},1032,["onClick"]),i(t,{style:{"font-size":"17px"},type:"primary",link:"",key:"plain",size:"small",onClick:a=>(async e=>{e&&(X(e),A.value="修改产品分类")})(e.row)},{default:s((()=>[u("修改")])),_:2},1032,["onClick"]),0!==e.row.parentTypeId?(r(),p(t,{type:"danger",style:{"font-size":"17px"},link:"",key:"plain",size:"small",onClick:a=>Z(e.row)},{default:s((()=>[u("删除")])),_:2},1032,["onClick"])):y("",!0)])),_:1})])),_:1},8,["data","default-expand-all"])),[[oe,l.tableLoading]]):y("",!0),i(ue,{title:A.value,modelValue:B.value,"onUpdate:modelValue":a[6]||(a[6]=e=>B.value=e),width:"30%"},{footer:s((()=>[i(t,{onClick:a[5]||(a[5]=e=>Q(E.value)),type:"primary",plain:""},{default:s((()=>[u("确定")])),_:1}),i(t,{onClick:W},{default:s((()=>[u("取消")])),_:1})])),default:s((()=>[i(se,{style:{"min-width":"300px"},ref_key:"ruleFormRef",ref:E,model:m($),rules:D,"label-width":"130px"},{default:s((()=>[i(le,{label:"父级分类",prop:"parentTypeId"},{default:s((()=>[i(ae,{disabled:"",options:m(Y),"show-all-levels":!1,props:R.value,modelValue:m($).parentTypeId,"onUpdate:modelValue":a[0]||(a[0]=e=>m($).parentTypeId=e)},null,8,["options","props","modelValue"])])),_:1}),i(le,{label:"子分类名称",prop:"itemTypeName"},{default:s((()=>[i(te,{style:{width:"198px"},modelValue:m($).itemTypeName,"onUpdate:modelValue":a[1]||(a[1]=e=>m($).itemTypeName=e)},null,8,["modelValue"])])),_:1}),i(le,{label:"显示排序",prop:"orderNum"},{default:s((()=>[i(re,{style:{width:"198px"},modelValue:m($).orderNum,"onUpdate:modelValue":a[2]||(a[2]=e=>m($).orderNum=e),min:0,"controls-position":"right"},null,8,["modelValue"])])),_:1}),i(le,{label:"物料/产品"},{default:s((()=>[i(ie,{modelValue:m($).itemOrProduct,"onUpdate:modelValue":a[3]||(a[3]=e=>m($).itemOrProduct=e)},{default:s((()=>[i(de,{label:"ITEM",size:"large"},{default:s((()=>[u("物料")])),_:1}),i(de,{label:"PRODUCT",size:"large"},{default:s((()=>[u("产品")])),_:1})])),_:1},8,["modelValue"])])),_:1}),i(le,{label:"启用状态",prop:"enableFlag"},{default:s((()=>[i(ie,{modelValue:m($).enableFlag,"onUpdate:modelValue":a[4]||(a[4]=e=>m($).enableFlag=e)},{default:s((()=>[i(de,{label:"Y",size:"large"},{default:s((()=>[u("是")])),_:1}),i(de,{label:"N",size:"large"},{default:s((()=>[u("否")])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])],64)}}}),[["__scopeId","data-v-b7d4a0bb"],["__file","/Users/alex/Downloads/万界星空/产品研发/MES框架/dev/xiejinrun/new_open_mes_front/src/views/masterData/materialClassify/components/tableModel.vue"]]),R=Object.freeze(Object.defineProperty({__proto__:null,default:D},Symbol.toStringTag,{value:"Module"}));export{R as a,S as q,E as s,D as t};
