import{q as e,f as a,D as l,d as t,K as s,e as i,g as r,C as o,o as n,c as m,k as u,w as d,a as c,I as p,F as f,n as b,t as v,G as y,J as k,z as _,L as h,M as g,N as w,H as I,at as S,au as U,aJ as C,a1 as x,a0 as T,_ as V}from"./index-4bfb878d.js";import{g as j,d as R,a as D,c as M,u as A}from"./index-2931315e.js";import{g as F}from"./index-5d266c5c.js";import{r as q}from"./formRules-eb36c657.js";import{u as z}from"./useVxeCrudSchemas-092b8963.js";import{u as E}from"./useXTable-309dffed.js";const{t:J}=e(),K=a({name:[q],description:[q],memberUserIds:[q],status:[q]}),L=a({primaryKey:"id",primaryType:"id",primaryTitle:"编号",action:!0,searchSpan:8,columns:[{title:"组名",field:"name",isSearch:!0},{title:"成员",field:"memberUserIds",table:{slots:{default:"memberUserIds_default"}}},{title:"描述",field:"description"},{title:J("common.status"),field:"status",dictType:l.COMMON_STATUS,dictClass:"number",isSearch:!0},{title:J("common.createTime"),field:"createTime",formatter:"formatDate",isForm:!1,isSearch:!0,search:{show:!0,itemRender:{name:"XDataTimePicker"}},table:{width:180}}]}),{allSchemas:N}=z(L),O=V(t({__name:"index",setup(a){const{t:l}=e(),t=s(),[V,{reload:q,deleteData:z}]=E({allSchemas:N,getListApi:j,deleteApi:R}),J=i([]),L=e=>{for(const a of J.value)if(a.id===e)return a.nickname;return"未知("+e+")"},O=i(!1),P=i(""),X=i(!1),G=i("edit"),H=i(),Q=i(),W=e=>{G.value=l("action."+e),P.value=e,X.value=!0},B=async()=>{var e;const a=null==(e=c(H))?void 0:e.getElFormRef();a&&a.validate((async e=>{var a;if(e){O.value=!0;try{const e=null==(a=c(H))?void 0:a.formModel;"create"===P.value?(await M(e),t.success(l("common.createSuccess"))):(await A(e),t.success(l("common.updateSuccess"))),X.value=!1}finally{O.value=!1,await q()}}}))};return r((()=>{F().then((e=>{J.value=e}))})),(e,a)=>{const t=h,s=g,i=w,r=I,j=S,R=U,M=C,A=x,F=T,q=o("hasPermi");return n(),m(f,null,[u(r,null,{default:d((()=>[u(i,{onRegister:c(V)},{toolbar_buttons:d((()=>[p(u(t,{type:"primary",preIcon:"ep:zoom-in",title:c(l)("action.add"),onClick:a[0]||(a[0]=e=>{W("create")})},null,8,["title"]),[[q,["bpm:user-group:create"]]])])),memberUserIds_default:d((({row:e})=>[(n(!0),m(f,null,b(e.memberUserIds,(e=>(n(),m("span",{key:e},v(L(e))+"   ",1)))),128))])),actionbtns_default:d((({row:e})=>[p(u(s,{preIcon:"ep:edit",title:c(l)("action.edit"),onClick:a=>(async e=>{var a;W("update");const l=await D(e);null==(a=c(H))||a.setValues(l)})(e.id)},null,8,["title","onClick"]),[[q,["bpm:user-group:update"]]]),p(u(s,{preIcon:"ep:view",title:c(l)("action.detail"),onClick:a=>(async e=>{W("detail"),Q.value=await D(e)})(e.id)},null,8,["title","onClick"]),[[q,["bpm:user-group:query"]]]),p(u(s,{preIcon:"ep:delete",title:c(l)("action.del"),onClick:a=>c(z)(e.id)},null,8,["title","onClick"]),[[q,["bpm:user-group:delete"]]])])),_:1},8,["onRegister"])])),_:1}),u(F,{modelValue:c(X),"onUpdate:modelValue":a[2]||(a[2]=e=>_(X)?X.value=e:null),title:c(G),"mask-closable":!1},{footer:d((()=>[["create","update"].includes(c(P))?(n(),y(t,{key:0,type:"primary",title:c(l)("action.save"),loading:c(O),onClick:B},null,8,["title","loading"])):k("",!0),u(t,{loading:c(O),title:c(l)("dialog.close"),onClick:a[1]||(a[1]=e=>X.value=!1)},null,8,["loading","title"])])),default:d((()=>[["create","update"].includes(c(P))?(n(),y(M,{key:0,schema:c(N).formSchema,rules:c(K),ref_key:"formRef",ref:H},{memberUserIds:d((e=>[u(R,{modelValue:e.memberUserIds,"onUpdate:modelValue":a=>e.memberUserIds=a,multiple:""},{default:d((()=>[(n(!0),m(f,null,b(c(J),(e=>(n(),y(j,{key:e.id,label:e.nickname,value:e.id},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1},8,["schema","rules"])):k("",!0),"detail"===c(P)?(n(),y(A,{key:1,schema:c(N).detailSchema,data:c(Q)},{memberUserIds:d((({row:e})=>[(n(!0),m(f,null,b(e.memberUserIds,(e=>(n(),m("span",{key:e},v(L(e))+"   ",1)))),128))])),_:1},8,["schema","data"])):k("",!0)])),_:1},8,["modelValue","title"])],64)}}}),[["__file","/Users/alex/Downloads/万界星空/产品研发/MES框架/dev/xiejinrun/new_open_mes_front/src/views/bpm/group/index.vue"]]);export{O as default};
